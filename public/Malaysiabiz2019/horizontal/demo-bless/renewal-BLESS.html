
<!-- saved from url=(0090)http://trainingb2.bless.gov.my/BLESS2_PROD_TEST/private/licKpdnkkPermitMain/renewal/374390 -->
<html xmlns="http://www.w3.org/1999/xhtml" class="gr__trainingb2_bless_gov_my"><!--Head--><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
        <title>BLESS 2.0</title>
        
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        
        <link rel="shortcut icon" type="image/x-icon" href="http://trainingb2.bless.gov.my/BLESS2_PROD_TEST/static/images/jata_2_0.png">
        <link rel="icon" type="image/x-icon" href="http://trainingb2.bless.gov.my/BLESS2_PROD_TEST/static/images/jata_2_0.png">  
        
        <!-- css -->
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/font-awesome-animation.min.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/font-awesome.min.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/spinkit.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/smartadmin-production-plugins.min.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/smartadmin-production.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/smartadmin-skins.min.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/smartadmin-rtl.min.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/elite.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/style.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/blue.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/jquery.treegrid.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/bootstrap-clockpicker.min.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/ajax_loading.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/animate.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/jquery.toast.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/sweetalert.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/my.style.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./renewal-BLESS 2.0_files/daterangepicker.css">
        

        <!-- js -->
        <script src="./renewal-BLESS 2.0_files/jquery-2.1.1.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/jquery-ui-1.10.3.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/jquery.cookie.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/app.config.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/jquery.inputmask.bundle.js.download"></script><style type="text/css">.im-caret {
	-webkit-animation: 1s blink step-end infinite;
	animation: 1s blink step-end infinite;
}

@keyframes blink {
	from, to {
		border-right-color: black;
	}
	50% {
		border-right-color: transparent;
	}
}

@-webkit-keyframes blink {
	from, to {
		border-right-color: black;
	}
	50% {
		border-right-color: transparent;
	}
}

.im-static {
	color: grey;
}
</style>
        <script src="./renewal-BLESS 2.0_files/bootstrap.min.js.download"></script>
        <!--<script th:src="@{/static/js/bootstrap/bootstrap-datepicker.min.js}"></script>-->
        <script src="./renewal-BLESS 2.0_files/SmartNotification.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/jquery.validate.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/jquery.maskedinput.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/select2.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/bootstrap-slider.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/jquery.mb.browser.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/app.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/mykad_reader.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/jquery-jvectormap-1.2.2.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/jquery-jvectormap-world-mill-en.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/moment.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/daterangepicker.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/jquery.fullcalendar.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/jquery.dataTables.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/datatables.responsive.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/ckeditor.js.download"></script><style>.cke{visibility:hidden;}</style>
        <script src="./renewal-BLESS 2.0_files/jquery.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/jquery.fileupload.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/bootstrap-timepicker.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/clockpicker.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/morris.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/raphael.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/chart.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/tinymce.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/jquery.bootstrap.newsbox.js.download"></script>
        
        
        
        <script src="./renewal-BLESS 2.0_files/jquery.canvasjs.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/jquery.toast.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/sweetalert.min.js.download"></script>
        
        <script src="./renewal-BLESS 2.0_files/jquery.numeric.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/numeral.min.js.download"></script>
        
        <script src="./renewal-BLESS 2.0_files/waypoints.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/jquery.counterup.min.js.download"></script>
        
        <script src="./renewal-BLESS 2.0_files/d3-3.5.6.min.js.download"></script>
        <script src="./renewal-BLESS 2.0_files/uvcharts.min.js.download"></script>
        
        <script src="./renewal-BLESS 2.0_files/printThis.js.download"></script>
        
        <script src="./renewal-BLESS 2.0_files/printThis.js.download"></script>
        
        <script>
            /*<![CDATA[*/
            $(function() {
                pageSetUp();
                //alertProcess();
                customSetup();
                runOnce();
                
                ajaxindicatorstart();
                
                $('.fieldset-title').after("<br/><hr/><br/>");
            });
            
            $(window).load(function(){
                ajaxindicatorstop();
            });
            
//            $(this).mousemove(function (e) {
//                if(parent.length > 0){
//                    try {
//                        parent.startTimer();
//                    } catch(e) {
//                    }
//                }
//            });
//
//            $(this).keypress(function (e) {
//                if(parent.length > 0){
//                    try {
//                        parent.startTimer();
//                    } catch(e) {
//                    }
//                }
//            });
            /*]]>*/
        </script>
        
        <!--Variables-->
        <script>
            /*<![CDATA[*/
            var cancelButtonText = 'Cancel';
            /*]]>*/
        </script>
            
        <!--Custom-->
        <script>
            /*<![CDATA[*/
            
            function runOnce(){
                $("form").attr("autocomplete", "off");
                $(".table").wrap('<div></div>');
                $(".table-location").html('<br/><table class="table table-bordered"><tr><td align="center"><div class="sk-circle"><div class="sk-circle1 sk-child"></div><div class="sk-circle2 sk-child"></div><div class="sk-circle3 sk-child"></div><div class="sk-circle4 sk-child"></div><div class="sk-circle5 sk-child"></div><div class="sk-circle6 sk-child"></div><div class="sk-circle7 sk-child"></div><div class="sk-circle8 sk-child"></div><div class="sk-circle9 sk-child"></div><div class="sk-circle10 sk-child"></div><div class="sk-circle11 sk-child"></div><div class="sk-circle12 sk-child"></div></div></td></tr></table>');
                $("#dt_list").css("width", "");
            }
                            
            function customSetup(){
                $("[title]").tooltip();
                $("input").css('padding-left','10px');
                $("textarea").css('padding-left','10px');
                
                plugin_datePicker();
                button_icon_preset();
                
                $('.dropdown-select2').select2("destroy");
                $('.dropdown-select2').select2({
                    allowClear:true
                });
                
                $(".loadSpinner").click(function(){
                    ajaxindicatorstart();
                });
                
                $('.open-date-picker').click(function(){
                    var idDatePicker = $(this).prev().attr('id');
                    if(idDatePicker){
                        $('#'+idDatePicker).datepicker('show');
                    }
                });
                
                $('.postcode').each(function(){
                    $(this).attr('data-mask','99999');
                    $(this).attr('data-mask-placeholder','x');
                });
                
                $('.required').each(function(){
                    labelAsRequired(this);
                });
                
                $('.custom-message').each(function(){
                    labelAsCustom(this);
                });
                
                $('.form-group').each(function(){
                    if (this.className.indexOf('form-group-sm') > -1) {
                    } else {
                        $(this).addClass("form-group-sm");
                    }
                });
                
                $('.year').each(function(){
                    $(this).attr('data-mask','9999');
                    $(this).attr('data-mask-placeholder','x');
//                    var jj = $(this).nextAll().html();
//                    if(jj == null){
//                        $(this).wrap('<div class="input-group"></div>');
//                        $(this).after('<span class="input-group-addon"><i class="fa fa-calendar"></i></span>');
//                    }
                });
                
                $('.year-set').each(function(){
                    $(this).attr('data-mask','9999');
                    $(this).attr('data-mask-placeholder','x');
                    var jj = $(this).nextAll().html();
                    if(jj == null){
                        $(this).wrap('<div class="input-group"></div>');
                        $(this).after('<span class="input-group-addon"><i class="fa fa-calendar"></i></span>');
                    }
                    $(this).val(new Date().getFullYear());
                });
                
                //below codes act as replacement while smart-style-6 problem is solved
                $('.currency').each(function(){
                    var jj = $(this).prevAll().html();
                    if(jj == null){
                        $(this).wrap('<div class="input-group"></div>');
                        $(this).css('text-align', 'right');
                        $(this).before('<span class="input-group-addon">RM</span>');
                    }
                });
                
                $(".nric").keydown(function (e) {
                    // allow: backspace, delete, tab, escape, enter, . , ctrl+a , home, end,  navigational
                    if ($.inArray(e.keyCode, [46, 8, 9, 27, 13]) !== -1 || (e.keyCode == 65 && e.ctrlKey === true) || (e.keyCode >= 35 && e.keyCode <= 40) || (e.keyCode >= 96 && e.keyCode <= 105)) {
                        return;
                    }
                    
                    if ((e.shiftKey || (e.keyCode < 47 || e.keyCode > 90))) {
                        e.preventDefault();
                    }
                });
                
                
                $(".numeric-no-negative").each(function(){
                   $(this).numeric(); 
                    $(this).keydown(function (e) {
                        if ((e.shiftKey || e.keyCode == 189)) {
                            e.preventDefault();
                        }
                    });
                });
                
                $(".numeric").each(function(){
                   $(this).numeric(); 
                });
                
                
                
                $(".numeric").change(function(){
                    var max_value = $(this).attr("max");
                    if(max_value) {
                        var value = this.value;
                        if(parseInt(value) <= parseInt(max_value)) {
                            this.value = value;
                        } else {
                            this.value = max_value;
                        }
                    }
                });
                
                $(".round-number").change(function(){
                    var value = this.value;
                    this.value = Math.floor(value);
                });
                
                $("input[type=number]").change(function(){
                   var a = $(this).val();
                   if(a < 0){
                       $(this).val(0);
                   }
                });
                
                $("input[type=text]").change(function(){
                    var containNotUppercaseClass = $(this).hasClass("not-uppercase");
                    if(!containNotUppercaseClass) {
                        this.value = this.value.toUpperCase();
                    }
                });
                
                $(".counter").counterUp({
                    delay: 100,
                    time: 1200
                });
                
                $('.wordcount').each(function(){
                    var id = this.id;
                    var jj = $(this).nextAll().html();
                    if(jj == null){
                        $(this).after('<span style="font-size: 11px; clear: both; margin-top: 3px; display: block;" id="counter-text-' + id + '">200</span>');
                    }
                });
                
                $('.wordcount').keyup(function() {
                    var id = this.id;
                    var limit = 200;
                    
                    text = $(this).val();
                    if(text === "") {
                        wordcount = 0;
                    } else {
                        wordcount = $.trim(text).split(" ").length;
                    }
                    
                    if(wordcount > 200) {
                        $("#counter-text-" + id).html('<span style="color: #DD0000;">0</span>');
                            limited = $.trim(text).split(" ", limit);
                            limited = limited.join(" ");
                            $(this).val(limited);
                    } else {
                        $("#counter-text-" + id).html((limit - wordcount));
                    } 
                    
                    $('#' + id).trigger("change");
                });
                
                $(".uppercase").change(function(){
                    this.value = this.value.toUpperCase();
                });
                
                $(".system-code").keypress(function(e){
                    var key = e.charCode || e.keyCode;
                    if((key >=48 && key <= 57) || (key >=65 && key <= 90) || (key >=97 && key <= 122) || key == 95){
                    } else {
                        e.preventDefault();
                    }
                });
                
                $(".system-code").each(function(e){
                    var jj = $(this).nextAll().html();
                    if(jj == null){
                        $(this).after('<div class="note">' + 'Only A-Z, 0-9 & _ are allowed' + '</div>');
                    }
                });
                
                $(".button-load").click(function(e){
                    var id = this.id;
                    var html = $(this).html();
                    
                    if(id != null) {
                        $("#" + id).prop("disabled", true);
                        
                        var count = 1;
                        var interval = setInterval(function(){
                            if(count >= 1 && count <=3 ) {
                                $("#" + id).html(count + "...");
                                count++;
                            } else if(count > 3) {
                                clearInterval(interval);
                                $("#" + id).html(html);
                                $("#" + id).prop("disabled", false);
                            }
                        }, 1000);
                    }
                });
                
                $(".email").change(function(){
                    if(isValidEmailAddress(this.value) == false) {
                        this.value = "";
                        alertWarningMessage('Please provide a valid email address');
                    }
                });

                runAllForms();
            }
            
            function tableLoading(divID){
                $("#" + divID).html('<br/><table class="table table-bordered"><tr><td align="center"><div class="cssload-speeding-wheel"></div></td></tr></table>');
            }
            
            function tableLoading(divID, border, message){
                if(border) {
                    $("#" + divID).html('<br/><table class="table table-bordered"><tr><td align="center"><div class="cssload-speeding-wheel"></div><br/>' + message + '</td></tr></table>');
                } else {
                    $("#" + divID).html('<br/><table width="100%"><tr><td align="center"><div class="cssload-speeding-wheel"></div><br/>' + message + '</td></tr></table>');
                }
            }
            
            function triggerChangeForm(formID){
                $("form#" + formID + " :input").each(function(){
                    $(this).trigger("change");
                });
            }
            
            /*]]>*/
        </script>
        
        <!--Button Icon Preset-->
        <script>
        /*<![CDATA[*/
            function button_icon_preset() {
                $('#btnSubmit').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-paper-plane'></i><span>"+'Submit'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnReset').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-default');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-refresh'></i><span>"+'Reset'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnSave').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-save'></i><span>"+'Save'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnBack').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-danger');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-arrow-left'></i><span>"+'Back'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnSearch').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-search'></i><span>"+'Search'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnDraft').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-file'></i><span>"+'Save as Draft'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnPreview').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-eye'></i><span>"+'Preview'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnChecklist').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-check-square-o'></i><span>"+'Checklist & Guidelines'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnReference').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-folder-open'></i><span>"+'Reference Document'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnViewComment').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-comment'></i><span>"+'View Comment'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnClaim').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-file-text-o'></i><span>"+'Claim'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnUnclaim').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-exchange'></i><span>"+'Unclaim'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnUpdateLicense').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-pencil-square-o'></i><span>"+'Update'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnSuspendLicense').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-tags'></i><span>"+'Suspend'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnUnholdLicense').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-tags'></i><span>"+'Unhold'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnCancel').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-eraser'></i><span>"+'Cancel/Cessation'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnTransHistory').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-history'></i><span>"+'Transaction History'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
                $('#btnReactivate').each(function(){
                    if(!$("#"+this.id).hasClass('custom-button')){
                        $("#"+this.id).removeAttr('class');
                        $("#"+this.id).addClass('btn btn-primary');
                        $(this).html(function(){
                            return "<i class='fa fa-1x fa-fw fa-check-square-o'></i><span>"+'Reactivate'+"</span>";
                        });

                        $("[title]").tooltip();
                    }
                });
            }
        /*]]>*/
        </script>
        
        <!--Plugin: Date/Range Picker-->
        <script>
        /*<![CDATA[*/
        
            function plugin_datePicker(){
                
                $('.datepicker-init').datepicker({
                    dateFormat: 'dd/mm/yy',
                    autoclose: true,
                    prevText: "<",
                    nextText: ">",
                });
                
//                $('.datepicker-init').each(function(){
//                    var id = this.id;
//                    var form_id = $(this).closest('form').attr('id');
//                    $(this).daterangepicker({
//                        autoApply: true,
//                        drops: 'up',
//                        showDropdowns: true,
//                        singleDatePicker: true,
//                        autoUpdateInput: false,
//                        locale: {
//                            format: 'DD/MM/YYYY',
//                        }
//                    }, function(start) {
//                        var format = 'DD/MM/YYYY';
//                        start = start.format(format);
//
//                        $("#" + id, "#" + form_id).val(start);
//                        $("#" + id, "#" + form_id).trigger("change");
//                    });
//                });

                $('.datepicker-init').each(function(){

                    var label = "<i class='fa fa-calendar'></i>";
                    var custom_label = $(this).attr("label");
                    if(custom_label) {
                        label = custom_label;
                    }

                    $(this).inputmask("dd/mm/yyyy");
                    var r=$(this).prop("readOnly");
                    var d=$(this).prop("disabled");//for disabled@readonly datepicker,doesnt add on icon datepicker
                    var jj = $(this).nextAll().html();
                    if(jj == null&&(!r&&!d)){
                        $(this).wrap('<div class="input-group"></div>');
                        $(this).after('<span class="input-group-addon open-date-picker">' + label + '</span>');
                    }
                });

                $('.rangepicker-init').each(function(){
                    var id = this.id;
                    var form_id = $(this).closest('form').attr('id');
                    var value = this.value.split(' - ');
                    
                    var dateLimit_option = {};
                    var year = $(this).attr('limit-year');
                    var day = $(this).attr('limit-day');
                    
                    if(year != null) {
                        dateLimit_option['year'] = year;
                    }
                    
                    if(day != null) {
                        dateLimit_option['day'] = day;
                    }
                    
                    var main_option = {
                        autoApply: true,
                        drops: 'up',
                        showDropdowns: true,
                        autoUpdateInput: false,
                        locale: {
                            format: 'DD/MM/YYYY'
                        },
                        dateLimit: dateLimit_option
                    };
                    
                    if(value[0] != "") {
                        main_option['startDate'] = value[0];
                    }
                    
                    if(value[1] != "") {
                        main_option['endDate'] = value[1];
                    }
                    
                    $(this).daterangepicker(main_option, function(start, end) {
                        var format = 'DD/MM/YYYY';
                        start = start.format(format);
                        end = end.format(format);

                        $("#" + id, "#" + form_id).val(start + ' - ' + end);
                        $("#" + id, "#" + form_id).trigger("change");
                    });
                });

                $('.rangepicker-init').each(function(){
                    var r=$(this).prop("readOnly");
                    var d=$(this).prop("disabled");//for disabled@readonly datepicker,doesnt add on icon datepicker
                    var jj = $(this).nextAll().html();
                    if(jj == null&&(!r&&!d)){
                        $(this).wrap('<div class="input-group"></div>');
                        $(this).after('<span class="input-group-addon open-date-picker"><i class="fa fa-calendar"></i></span>');
                    }
                });
                
                $('.timepicker-init').timepicker({
                    defaultTime: false,
                    readonly: true,
                    timeFormat:'hh:mm p',
                    minTime: '08:00 AM',
                    maxTime: '12:00 AM',
                    minuteStep: 30
                });
                
                $('.timepicker-init').each(function(){
                    var jj = $(this).nextAll().html();
                    if(jj == null){
                         $(this).wrap('<div class="input-group"></div>');
                        $(this).after('<span class="input-group-addon"><i class="fa fa-clock-o"></i></span>');
                    }
                });
                
                $('.clockpicker-init').clockpicker({
                    default: 'now',
                    donetext: "<i class='fa fa-check'></i>",
                    twelvehour: true
                });
                
                $('.clockpicker-init').each(function(){
                    var jj = $(this).nextAll().html();
                    if(jj == null){
                        $(this).wrap('<div class="input-group"></div>');
                        $(this).after('<span class="input-group-addon"><i class="fa fa-clock-o"></i></span>');
                    }
                });
            }
        
        /*]]>*/
        </script>
        
        <!--Load Options-->
        <script>
            /*<![CDATA[*/
            var contextPath = /BLESS2_PROD_TEST/;
            
            function loadCityByState(stateId, cityId, function_callback, formId){
                removeOptionsExceptFirst(cityId);
                $('#' + cityId, "#" + formId).select2("val", "");
                
                $.ajax({
                    url: contextPath + "/private/refCity/ajax/loadCityByState",
                    method: "get",
                    data: "stateId=" + $("#" + stateId).select2("val"),
                    success: function(data) {
                        $.each(data, function(a,b){
                            $("#"+cityId, "#" + formId).append('<option value="'+b.cityId+'">'+b.cityName+'</option>');
                        });
                        
                        if(function_callback != null) {
                            function_callback();
                        }
                   }
                });
            }
            
            function loadCityByStateOther(stateId, cityId){
                removeOptionsExceptFirst(cityId);
                $('#' + cityId).select2("val", "");
                
                $.ajax({
                    url: contextPath + "/private/refCity/ajax/loadCityByState",
                    method: "get",
                    data: "stateId=" + $("#" + stateId).select2("val"),
                    success: function(data) {
                        $.each(data, function(a,b){
                            $("#"+cityId).append('<option value="'+b.cityId+'">'+b.cityName+'</option>');
                        });
                   }
                });
            }
            
            function loadProcessingAgencyByState(stateCode, selected, licenseMetaId, tgtSelectId){
                if(stateCode == "" || stateCode == null) {
                    removeOptionsExceptFirst(tgtSelectId);
                } else {
                    $.ajax({
                        url: contextPath + "/private/refAgency/ajax/getAgency/" + stateCode + "/" + licenseMetaId,
                        method: "GET",
                        success: function(data){
                            removeOptionsExceptFirst(tgtSelectId);
                            $.each(data, function(a, b){
                                $("#" + tgtSelectId).append('<option value="'+b.agencyId+'">'+b.agencyName+'</option>');
                            });
                            if(selected != "null") {
                                $("#" + tgtSelectId).select2("val", selected);
                            }
                        }
                    })
                }
            }
            
            function loadLicensingAgencyByState(stateCode, selected, licenseMetaId, tgtSelectId){
                if(stateCode == "" || stateCode == null) {
                    removeOptionsExceptFirst(tgtSelectId);
                } else {
                    $.ajax({
                        url: contextPath + "/private/refLicenseAgency/ajax/getLicensingAgency/" + stateCode + "/" + licenseMetaId,
                        method: "GET",
                        success: function(data){
                            removeOptionsExceptFirst(tgtSelectId);
                            $.each(data, function(a, b){
                                $("#" + tgtSelectId).append('<option value="'+b.refLicenseAgencyId+'">'+b.agencyName+'</option>');
                            });
                            
                            if(selected != null) {
                                $("#" + tgtSelectId).select2("val", selected);
                            } else if(data.length === 1) {
                                $("#" + tgtSelectId).select2("val", $("#" + tgtSelectId + " option:eq(1)").val());
                            }
                        }
                    })
                }
            }
            
            function loadAgencyByParent(parentId, childId){
                $('#' + childId).find('option:gt(0)').remove();
                $('#' + childId).select2("val", "");
                
                $.ajax({
                   url: contextPath + "/private/refAgency/loadAgencyByParent",
                   method: "get",
                   data: "parentId=" + $("#" + parentId).select2("val"),
                   success: function(data) {
                       $.each(data, function(a,b){
                           $("#"+childId).append('<option value="'+b.agencyId+'">'+b.agencyCode+'-'+ b.agencyName + '</option>');
                       })
                   }
                });
            }
            
            function getUrlParameter(sParam) {
                var sPageURL = decodeURIComponent(window.location.search.substring(1));
                var sURLVariables = sPageURL.split('&');
                var sParameterName;
                var i;

                for(i = 0; i < sURLVariables.length; i++){
                    sParameterName = sURLVariables[i].split('=');

                    if(sParameterName[0] === sParam) {
                        return sParameterName[1] === undefined ? true : sParameterName[1];
                    }
                }
            }
            /*]]>*/
        </script>
        
        <!--Validation-->
        <script>
            /*<![CDATA[*/
            function validateForm(array, formId){
                var countFail = 0;
                var alertContent = "";
                
                $.each(array, function(index, value){
                    
                    var content = $("#" + value.id, "#" + formId).val();                    
                    if(content == null) {
                        content = $("#" + formId+" input[name="+value.id+"]").val();
                    }
                    if(content == null) {
                        content = $("#" + value.id).val();
                    }
                    var type = $("#" + value.id, "#" + formId).prop('type');
                    if(type == null) {
                        type = $("#" + formId+" input[name="+value.id+"]").prop('type');
                    }                    
                    var message = value.message.replace("'", '').replace("'", '');
                    log(content);
                    
                    if(type === "checkbox") {
                        var checked = $("#" + value.id, "#" + formId).is(':checked');
                        if(!checked) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    } else if(type === "radio") {
                        var selected = $('input[id='+value.id+']:checked', '#' + formId).val();
                        if(!selected) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    } else if(type === "radio") {
                        var selected = $('input[id='+value.id+']:checked', '#' + formId).val();
                        if(!selected) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    } else if(type === "number") {
                        var allow_zero = $("#" + value.id, "#" + formId).hasClass("allow-zero");
                        if(!allow_zero && content == 0) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }else if(allow_zero && content === ""){
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    } else if(type === "email"){
                        if(!isValidEmailAddress(content)){
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    } else if(type === "select-one"){
                        //Dropdown
                        if(!content){
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    } else {
                        if(content === "" || content == 0 || content == null) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    }
                });
                
                if(countFail > 0) {
                    $.toast({
                        heading: "<b>"+countFail+" Field(s) required</b>",
                        text: alertContent,
                        position: 'top-right',
                        loaderBg:'#ff6849',
                        icon: 'error',
                        hideAfter: 3000, 
                        stack: 1
                    });
                }
                
                return countFail;
            }
            
            function validateFormReturnsContent(array, formId){
                var countFail = 0;
                var alertContent = "";
                
                $.each(array, function(index, value){
                    var content = $("#" + value.id, "#" + formId).val();
                    var type = $("#" + value.id, "#" + formId).prop('type');
                    var message = value.message.replace("'", '').replace("'", '');
                    
                    var isReadonly = $('#' + value.id, '#' + formId).attr('readonly');
                    
                    if(isReadonly) {
                        return true;
                    } else if(type === "checkbox") {
                        var checked = $("#" + value.id, "#" + formId).is(':checked');
                        if(!checked) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    } else if(type === "radio") {
                        var selected = $('input[id='+value.id+']:checked', '#' + formId).val();
                        if(!selected) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    } else if(type === "radio") {
                        var selected = $('input[id='+value.id+']:checked', '#' + formId).val();
                        if(!selected) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    } else if(type === "number") {
                        if(content == 0) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    } else {
                        if(content === "" || content == 0) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    }
                });
                
                return alertContent;
            }
            
            function validateFormReturnsContent2(array, formId, count){
                var countFail = count;
                var alertContent = "";
                
                $.each(array, function(index, value){
                    var content = $("#" + value.id, "#" + formId).val();
                    var type = $("#" + value.id, "#" + formId).prop('type');
                    var message = value.message.replace("'", '').replace("'", '');
                    
                    var isReadonly = $('#' + value.id, '#' + formId).attr('readonly');
                    
                    if(isReadonly) {
                        return true;
                    } else if(type === "checkbox") {
                        var checked = $("#" + value.id, "#" + formId).is(':checked');
                        if(!checked) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    } else if(type === "radio") {
                        var selected = $('input[id='+value.id+']:checked', '#' + formId).val();
                        if(!selected) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    } else if(type === "radio") {
                        var selected = $('input[id='+value.id+']:checked', '#' + formId).val();
                        if(!selected) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    } else if(type === "number") {
                        if(content == 0) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    } else {
                        if(content === "" || content == 0) {
                            countFail++;
                            alertContent = alertContent + "<br>" + countFail + ". " + message;
                        }
                    }
                });
                
                return alertContent;
            }
            
            function validateFormReturnsCountNoAlert(array, formId){
                var countFail = 0;
                
                $.each(array, function(index, value){
                    var content = $("#" + value.id, "#" + formId).val();
                    var type = $("#" + value.id, "#" + formId).prop('type');
                    var message = value.message.replace("'", '').replace("'", '');
                    
                    var isReadonly = $('#' + value.id, '#' + formId).attr('readonly');
                    
                    if(isReadonly) {
                        return true;
                    } else if(type === "checkbox") {
                        var checked = $("#" + value.id, "#" + formId).is(':checked');
                        if(!checked) {
                            countFail++;
                        }
                    } else if(type === "radio") {
                        var selected = $('input[id='+value.id+']:checked', '#' + formId).val();
                        if(!selected) {
                            countFail++;
                        }
                    } else if(type === "radio") {
                        var selected = $('input[id='+value.id+']:checked', '#' + formId).val();
                        if(!selected) {
                            countFail++;
                        }
                    } else if(type === "number") {
                        if(content == 0) {
                            countFail++;
                        }
                    } else {
                        if(content === "" || content == 0) {
                            countFail++;
                        }
                    }
                });
                
                return countFail;
            }
            
            function validateSubmit(array, form){
                var countFail = validateForm(array, form);
                if(countFail == 0){
                    $("#" + form).submit();
                }
            }
            
            function validateSubmit2(array, form, callback){
                var countFail = validateForm(array, form);
                if(countFail == 0){
                    $("#" + form).submit();
                }else {
                    callback();
                }
            }
            
            function validateSubmit_class(array, form){
                var countFail = 0;
                $.each(array, function(index, value){
                    $("." + value.id).each(function(){
                       var content = $(this).val();
                       if(content === ""){
                            countFail++;
                            alert4("Error", value.message + ' ' + "is required", 'warning');
                        }
                    });
                });

                if(countFail == 0){
                    $(form).submit();
                }
            }
            /*]]>*/
        </script>
        
        <!--Alert-->
        <script>
            /*<![CDATA[*/
            function errorAlert(){
                var title = "Error";
                //var message = "Please contact system administrator for further action.";
                //alert4(title, message, 'error');
            }
            
            function alertProcess() {
                var result = "[[${param.result[0]}]]";
                var r = "[[${param.r[0]}]]";
                var content = "[[#{${param.result[0]}+'.content'}]]";
                alert(result, r, content);
                
                if(result.indexOf("param.result") != -1 ){
                    var sResult = "[[${param.sResult[0]}]]";
                    var successTitle = "<b>[[#{${param.sResult[0]}+'.title'}]]</b>";
                    var totalSuccess = "[[${param.totalSuccess[0]}]]";
                    var successContent = "[[#{${param.sResult[0]}+'.content'}]]";
                    
                    //failure
                    var fResult = "[[${param.fResult[0]}]]";
                    var failureTitle = "<b>[[#{${param.fResult[0]}+'.title'}]]</b>";
                    var totalFailure = "[[${param.totalFailure[0]}]]";
                    var failureContent = "[[#{${param.fResult[0]}+'.content'}]]";
                    
                    alert(sResult, '', totalSuccess + "/" + totalFailure + " " + successContent);
                }
            }
            
            function alert(result, r, content) {
                if (result.indexOf("success") != -1) {
                    var successTitle = "Success";
                    alert2(successTitle, content, "success", r);
                } else if (result.indexOf("failure") != -1) {
                    var failureTitle = "Error";
                    alert2(failureTitle, content, "warning", r);
                }
            }
            
            function alert2(title, content, result, r) {
                if(r == "") {
                    alert3(title, content, result);
                    return;
                }
                else if(r.indexOf("param")!= -1) {
                    alert3(title, content, result);
                    return;
                }
                var exist = localStorage.getItem(r);
                if (exist == "done") {
                    return;
                } else {
                    localStorage.setItem(r, "done");
                    alert3(title, content, result);
                }
            }
            
            function alert3(title, content, result) {
                $.toast({
                    heading: title,
                    text: content,
                    position: 'top-right',
                    loaderBg:'#ff6849',
                    icon: result,
                    hideAfter: 3000, 
                    stack: 1
                });
            }
            
            function alert4(title, content, result) {
                $.toast({
                    heading: title,
                    text: content,
                    position: 'top-right',
                    loaderBg:'#ff6849',
                    icon: result,
                    hideAfter: 3000, 
                    stack: 6
                });
            }
            
            function alertAction(action, result){
                var title = "";
                var message = "";
                var icon = "";
                
                if(result === "OK"){
                    title = "Success";
                    icon = "success";
                } else {
                    title = "Error";
                    icon = "warning";
                }
        
                if(action === "insert"){
                    if(result === "OK"){
                        message = "New record successfully added";
                    } else {
                        message = "New record added failure";
                    }
                } else if(action === "update"){
                    if(result === "OK"){
                        message = "Record successfully updated";
                    } else {
                        message = "Record updated failure";
                    }
                } else if(action === "delete"){
                    if(result === "OK"){
                        message = "Record successfully deleted";
                    } else {
                        message = "Record failed to delete";
                    }
                }
                
                alert4(title, message, icon);
            }
            
            function alertCustomMessage(content, result){
                var title = "";
                var message = content;
                var icon = "";
                
                if(result === "OK"){
                    title = "Success";
                    icon = "success";
                } else if(result === "ERROR"){
                    title = "Alert";
                    icon = "warning";
                }else {
                    title = "Error";
                    icon = "warning";
                }
                
                alert4(title, message, icon);
            }
            
            function alertWarningMessage(content){
                var title = "Alert";
                var message = content;
                var icon = "warning";
                
                alert4(title, message, icon);
            }
            
            function alertCallbackY(title, text, confirmBtnText, callback){
                var _confirmBtnText = 'Yes';
                if(confirmBtnText != null && confirmBtnText != '') {
                    _confirmBtnText = confirmBtnText;
                }
                
                alertCallback(title, text, false, _confirmBtnText, callback, null);
            }
            
            function alertCallbackYN(title, text, confirmBtnText, callback_true, callback_false){
                var _confirmBtnText = 'Yes';
                if(confirmBtnText != null && confirmBtnText != '') {
                    _confirmBtnText = confirmBtnText;
                }
                
                alertCallback(title, text, true, _confirmBtnText, callback_true, callback_false);
            }
            
            function alertCallback(title, text, showCancelBtn, confirmButtonText, callback_true, callback_false){
                swal({   
                    html: true,
                    title: title,
                    text: text,
                    showCancelButton: showCancelBtn,   
                    confirmButtonColor: "#00aaf2",   
                    confirmButtonText: confirmButtonText,   
                    cancelButtonText: cancelButtonText,
                    closeOnConfirm: true 
                }, function(result){
                    if(callback_true && callback_false) {
                        if(result) {
                            callback_true();
                        } else {
                            callback_false();
                        }
                    } else {
                        if(result) {
                            callback_true();
                        }
                    }
                });
            }
            /*]]>*/
        </script>
            
        <!--Utilities-->
        <script>
            /*<![CDATA[*/
            function getDatagridSelectedValue(){
                var ids = [];
                dtSelectRow.each(function(key, value, index){
                    ids.push(value);
                });
                return ids;
            }
            
            function labelAsRequired(thiz){
                var id = $(thiz).prop('id');
                var content = $(thiz).html().replace('*','');
                
                $(thiz).html('');
                $(thiz).append("<span>" + content + "</span><b id='label_required_" + id + "' style='color: red'> *</b>");
            }
            
            function labelAsCustom(thiz){
                var content = $(thiz).text();

                $(thiz).html('');
                $(thiz).append("<span>" + content + "</span>");
            }
            
            function toDateString(dateStr) {
                if(dateStr == null || dateStr === ''){
                    return "";
                } else {
                    var parts = dateStr.split("-");
                    return parts[2] + '/' + parts[1] + '/' + parts[0];
                }
            }
            
            function addMonthToDate(dateStr, total_months){
                if(dateStr) {
                    var date = moment([dateStr.substr(6,4),dateStr.substr(3,2)-1,dateStr.substr(0,2)]).add(total_months, 'months');
                    date = date.subtract(1, 'days');
                    return date.format('DD/MM/YYYY');
                } else {
                    return null;
                }
            }
            
            function substractMonthFromDate(dateStr, total_months){
                if(dateStr) {
                    var date = moment([dateStr.substr(6,4),dateStr.substr(3,2)-1,dateStr.substr(0,2)]).subtract(total_months, 'months');
                    return date.format('DD/MM/YYYY');
                } else {
                    return null;
                }
            }
            
            function addMonthToDateStartOfMonth(dateStr, total_months){
                var date = moment([dateStr.substr(6,4),dateStr.substr(3,2)-1,dateStr.substr(0,2)]).add(total_months, 'months');
                date = moment(date).startOf('month');
                return date.format('DD/MM/YYYY');
            }
            
            function date2IsBeforeDate1(date1, date2) {
                
                var date1M = moment([date1.substr(6,4),date1.substr(3,2)-1,date1.substr(0,2)]);
                var date2M = moment([date2.substr(6,4),date2.substr(3,2)-1,date2.substr(0,2)]);
                
                return date2M < date1M;
            }
            
            function getAge(dateStr){
               var date = moment([dateStr.substr(6,4),dateStr.substr(3,2)-1,dateStr.substr(0,2)]);
               var birth_year = date.format('YYYY');
               var current_year = moment().format('YYYY');
               var age = parseInt(current_year)-parseInt(birth_year);
               return age;
            }
            
            function equalsIgnoreCase(string1, string2) {
                string1 = string1.toLowerCase();
                string2 = string2.toLowerCase();
                
                if(string1 === string2) {
                    return true;
                } else {
                    return false;
                }
            }
            
            function appendRow(id, data){
                $("#" + id + " tbody tr:last").after(data);
            }
            
            function removeRowExceptFirst(id){
                $("#" + id + " tr:gt(0)").remove();
            }
            
            function removeOptionsExceptFirst(id) {
                $('#' + id).find('option:gt(0)').remove();
                $('#' + id).select2('val', '');
            }
            
            function selectFirstOption(id) {
                $('#' + id).select2('val', $('#' + id + ' option:eq(1)').val());
            }
            
            function removeTblAction(tableId) {
                var table = $("#" + tableId).find("tr");
                table.find("td:last").remove();
                table.find("th:last").remove();
            }
            
            function appendOption(id, value, text) {
                $('#' + id).append('<option value="' + value + '">' + text + '</option');
            }
            
            function appendOptionCode(id, code, value, text) {
                $('#' + id).append('<option value="' + value + '" code="' + code + '">' + text + '</option');
            }
            
            function formatAddressVertical(address_1, address_2, address_3, postcode, city, state, country) {
                address_1 = address_1 == null ? "" : address_1;
                address_2 = address_2 == null ? "" : address_2;
                address_3 = address_3 == null ? "" : address_3;
                postcode = postcode == null ? "" : postcode;
                city = city == null ? "" : city;
                state = state == null ? "" : state;
                country = country == null ? "" : country;

                address_1 = address_1 + "\n";
                address_2 = address_2 + "\n";
                address_3 = address_3 + "\n";

                var postcode_city = "";
                if (postcode != "" && city != "") {
                    postcode_city = postcode + ", " + city + "\n";
                } else if (postcode != "" && city == "") {
                    postcode_city = postcode + ", ";
                } else if (postcode == "" && city != "") {
                    postcode_city = city + ", ";
                }

                var full_address = address_1 + address_2 + address_3 + postcode_city + state + "\n" + country;
                return full_address;
            }
            
            function _replace(string, search, replace){
                var my_regex = new RegExp(search, 'g');
                return string.replace(my_regex, replace);
            }
            
            function loadShowModal(modalLocationId, modalId, html){
                $("#" + modalLocationId).html(html);
                customSetup();
                $("#" + modalId).modal("show");
            }
            
            function log(text){
                console.log(text == null? "LOG HERE!" : text);
            }
            
            function isValidEmailAddress(emailAddress) {
                var pattern = /^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i;
                return pattern.test(emailAddress);
            };
            
            /*]]>*/
        </script>
            
        <!--Form Tools-->
        <script>
            /*<![CDATA[*/
            function resetForm(formId){
                
//                $('#' + formId)[0].reset();
                $("select", "#" + formId).select2("val", "");
                
                $("input", "#" + formId).not("[readonly],[disabled]").val("");
                $("textarea", "#" + formId).not("[readonly],[disabled]").val("");
                $("input:checkbox", "#" + formId).not("[readonly],[disabled]").prop("checked", false);
            }
            
            function resetAndEnableForm(formId){
                resetForm(formId);
                enableForm(formId);
            }
            
            function enableForm(formId){
                $("#" + formId + " :input").prop("disabled", false);
                $("#" + formId + " select").prop("disabled", false);
            }
            
            function disableForm(formId){
                $("#" + formId + " :input").prop("disabled", true);
                $("#" + formId + " select").prop("disabled", true);
            }
            /*]]>*/
        </script>
        
        <!--Ajax Spinner-->
        <script>
            /*<![CDATA[*/
            function ajaxindicatorstart() {
                var imagePath = contextPath + "/static/images/loader.gif";
                var load_image = '<div class="cssload-speeding-wheel"></div>';
                if (jQuery('body').find('#resultLoading').attr('id') !== 'resultLoading') {
                    jQuery('body').append('<div id="resultLoading" style="display:none"><div>'+load_image+'</div><div class="bg"></div></div>');
                }
                jQuery('#resultLoading').css({
                    'width': '100%',
                    'height': '100%',
                    'position': 'fixed',
                    'z-index': '10000000',
                    'top': '0',
                    'left': '0',
                    'right': '0',
                    'bottom': '0',
                    'margin': 'auto'
                });
                jQuery('#resultLoading .bg').css({
                    'background': '#ffffff',
                    'opacity': '0.7',
                    'width': '100%',
                    'height': '100%',
                    'position': 'absolute',
                    'top': '0'
                });
                jQuery('#resultLoading>div:first').css({
                    'width': '250px',
                    'height': '75px',
                    'text-align': 'center',
                    'position': 'fixed',
                    'top': '0',
                    'left': '0',
                    'right': '0',
                    'bottom': '0',
                    'margin': 'auto',
                    'font-size': '16px',
                    'z-index': '10',
                    'color': '#ffffff'
                });
                jQuery('#resultLoading .bg').height('100%');
                jQuery('#resultLoading').fadeIn(300);
                jQuery('body').css('cursor', 'wait');
            }

            function ajaxindicatorstop() {
                jQuery('#resultLoading .bg').height('100%');
                jQuery('#resultLoading').fadeOut(300);
                jQuery('body').css('cursor', 'default');
            }

            jQuery(document).ajaxStart(function () {
            //show ajax indicator
                ajaxindicatorstart();
            }).ajaxStop(function () {
            //hide ajax indicator
                ajaxindicatorstop();
            }).ajaxSuccess(function () {
            //hide ajax indicator
                ajaxindicatorstop();
            }).ajaxError(function () {
                var title = "Error";
                //var message = "Request failed, please contact system administrator for further actions.";
                //alert4(title, message, 'error');
                ajaxindicatorstop();
            });
            /*]]>*/
        </script>
            
        <!--Others-->
        <script>
            /*<![CDATA[*/
            setSoundPath(contextPath + "/static/sound/");
            
            function showError() {
                webix.ui({
                    view:"window",
                    buttons:["OK"],
                    fullscreen:true,
                    id:"errorDialog",
                    head:{
                        view:"toolbar", css:"toolbar_error", cols:[
                            {view:"label", label: "System Error" },
                            { view:"button", label: "Report", width: 100, align: 'right', click:"$$('errorDialog').close();"},
                            { view:"button", label: "Close", width: 100, align: 'right', click:"$$('errorDialog').close();"}
                        ]
                    },
                    body:{
                        view:"scrollview", body:{
                            rows:[
                                { view: "iframe",src:contextPath+"/private/error" },
                            ]
                        }
                    }
                }).show();
            }
            
            function createCkEditor(id, height) {
                    //create ckeditor
                    return $('#' + id).ckeditor({
                        height: height + 'px', 
                        paste_data_images: true,
                        toolbar : [
                        { name: 'clipboard', groups: [ 'clipboard', 'undo' ], items: [ 'Cut', 'Copy', 'Paste', 'PasteText', 'PasteFromWord', '-', 'Undo', 'Redo' ] },
                        { name: 'editing', groups: [ 'find', 'selection', 'spellchecker' ], items: [ 'Find', 'Replace', '-', 'SelectAll', '-', 'Scayt' ] },
                        { name: 'basicstyles', groups: [ 'basicstyles', 'cleanup' ], items: [ 'Bold', 'Italic', 'Underline', 'Strike', 'Subscript', 'Superscript', '-', 'RemoveFormat' ] },
                        { name: 'paragraph', groups: [ 'list', 'indent', 'blocks', 'align', 'bidi' ], items: [ 'NumberedList', 'BulletedList', '-', 'Outdent', 'Indent', '-', 'Blockquote', '-', 'JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock', '-', 'BidiLtr', 'BidiRtl', 'Language' ] },
                        { name: 'links', items: [ 'Link', 'Unlink', 'Anchor' ] },
                        { name: 'insert', items: ['Table', 'HorizontalRule', 'SpecialChar', 'PageBreak', 'Image' ] },
                                '/',
                        { name: 'styles', items: [ 'Styles', 'Format', 'Font', 'FontSize' ] },
                        { name: 'colors', items: [ 'TextColor', 'BGColor' ] },
                        { name: 'tools', items: [ 'Maximize', 'ShowBlocks' ] },
                    ],
                        // Toolbar groups configuration.
                        toolbarGroups : [
                        { name: 'clipboard', groups: [ 'clipboard', 'undo' ] },
                        { name: 'editing', groups: [ 'find', 'selection', 'spellchecker' ] },
                                '/',
                        { name: 'basicstyles', groups: [ 'basicstyles', 'cleanup' ] },
                        { name: 'paragraph', groups: [ 'list', 'indent', 'blocks', 'align', 'bidi' ] },
                        { name: 'links' },
                        { name: 'insert' },
                                '/',
                        { name: 'styles' },
                        { name: 'colors' },
                        { name: 'tools' },
                        { name: 'others' },
                        ]});
                    }
            /*]]>*/
        </script>
        
        <!--UPLOADER-->
        <script>
        /*<![CDATA[*/
            var backUrl = '/BLESS2_PROD_TEST/private/licKpdnkkPermitMain/renewal/374390';
            
            function file_uploader(contextPath, protect, prefix, referenceId, allowContentType, upload_confirmation) {
                var tgtConfigurer = contextPath + "/" + protect + "/upload/configure";
                $.post(tgtConfigurer, function(a) {
                    var uploadMaxSizefile = a.uploadMaxSizefile;
                    file_uploader0(contextPath, protect, prefix, referenceId, allowContentType, upload_confirmation, uploadMaxSizefile);  
                });
            }
                
            function file_uploader0(contextPath, protect, prefix, referenceId, allowContentType, upload_confirmation, uploadMaxSizefile) {    
                
                var tgtUploader = contextPath + "/" + protect + "/upload/" + prefix + "/" + referenceId;
                
                //init button upload
                $('#btn' + referenceId).click(function() {
                    $('#' + referenceId).click();
                });
                
                //hide progress
                $('#progress' + referenceId).hide();

                $('#info' + referenceId).hide();
                        
                //load list
                viewUploader(contextPath, protect, prefix, referenceId);
                
                //init fileupload
                $('#' + referenceId).fileupload({
                    url: tgtUploader,
                    dataType: 'json',
                    progressall: function (e, data) {
                        $('#progress' + referenceId).show();
                        $('#btn' + referenceId).hide();
                        var progress = parseInt(data.loaded / data.total * 100, 10);
                        $('#progress' + referenceId).attr('value', progress);
                        if (progress >= 100) {
                            $('#progress' + referenceId).hide();
                            $('#info' + referenceId).show();
                        }
                    },
                    add: function (e, data) {
                        
                        if(upload_confirmation) {
                            swal({   
                                html: true,
                                title: upload_confirmationTitle,
                                text: upload_confirmationContent,
                                confirmButtonText: "Yes",
                                cancelButtonText: "No",
                                closeOnConfirm: true 
                            }, function(result){
                                if(result) {
                                    fileUpload_onAdd_event(data, protect, prefix, referenceId,uploadMaxSizefile);
                                }
                            });
                        } else {
                            fileUpload_onAdd_event(data, protect, prefix, referenceId,uploadMaxSizefile);
                        }
                        
                    },
                    done: function (e, data) {
                    }
                });
            }
            
            function fileUpload_onAdd_event(data, protect, prefix, referenceId,uploadMaxSizefile){
                resetUploader(referenceId);
                $('#desc' + referenceId).html("");
                var uploadErrors = [];

                if(allowContentType){
                    if (data.originalFiles[0]['type'].length) {
                        var t = data.originalFiles[0]['type'].toLowerCase();
                        var b = 0;
                        var allow;
                        if (allowContentType) {
                            var allow = allowContentType.split(",");
                            for (i = 0; i < allow.length; i++) {
                                if (t.indexOf("/" + allow[i]) != - 1) {
                                    b = 1;
                                    break;
                                }
                            }
                            if (b == 0) {
                                var msg = "";
                                msg += "<b>" + allowContentType.toUpperCase().replace("VND.OPENXMLFORMATS-OFFICEDOCUMENT.WORDPROCESSINGML.DOCUMENT","DOCX").replace("MSWORD","DOC") + "</b>";
                                errorUploader(referenceId, "Only " + msg + " file type allowed");
                                return false;
                            }
                        }
                    } else {
                        if (allowContentType) {
                            var msg = "";
                            msg += "<b>" + allowContentType.toUpperCase().replace("VND.OPENXMLFORMATS-OFFICEDOCUMENT.WORDPROCESSINGML.DOCUMENT","DOCX").replace("MSWORD","DOC") + "</b>";
                            errorUploader(referenceId, "Only " + msg + " file type allowed");
                            return false;
                        }
                    }
                }

                if (data.originalFiles[0]['size'].length && data.originalFiles[0]['size'] > uploadMaxSizefile) {
                    errorUploader(referenceId, 'Filesize is too big');
                    return false;
                }

                data.submit().success(function (result, textStatus, jqXHR) {
                    if (result.success == false) {
                        errorUploader(referenceId, 'ERROR'); 
                    } else {
                        viewUploader(contextPath, protect, prefix, referenceId); 
                    }
                }).error(function (jqXHR, textStatus, errorThrown) {
                    errorUploader(referenceId, textStatus)
                }).complete(function (result, textStatus, jqXHR) {
                });
            }
            
            //view list of fileupload
            var acfsFileNo = 0;
            function viewUploader(contextPath, protect, prefix, referenceId) {
                $('#progress' + referenceId).hide();
                $('#info' + referenceId).hide();
                $('#desc' + referenceId).html("");
                var tgtViewer = contextPath + "/" + protect + "/upload/view/" + prefix + "/" + referenceId;
                $("#div" + referenceId).html("<i class='fa fa-gear fa-spin'></i>");
                $.get(tgtViewer, function(data) {
                    $("#div" + referenceId).html(data);
                    $("[title]").tooltip();
                    $('#btn' + referenceId).show();
                }).error(function() {
                    $("#div" + referenceId).html("Error");
                    $('#btn' + referenceId).show();
                });
            }

            function errorUploader(id, textStatus) {
                $('#desc' + id).html("<span class='alert alert-danger'>" + textStatus + "</span>");
                $('#progress' + id).hide();
                $('#info' + referenceId).hide();
                $('#btn' + id).show();
            }

            function resetUploader(id) {
                $('#desc' + referenceId).html("");
                $('#progress' + id).show();
                $('#btn' + id).show();
                $('#info' + referenceId).hide();
            }
                    
            function doDeleteUploader(thiz) {
                var tgtTitleConfirmDelete = 'Are you sure to delete file?';
                var text = 'File will be permanently deleted.';
                var buttonNo = 'No';
                var buttonYes = 'Yes';

                alertCallbackYN(tgtTitleConfirmDelete, text, '', function(){
                    $.post($(thiz).attr('zhref'), function(r) {
                        viewUploader(r.contextPath, r.protect, r.prefix, r.referenceId);
                    });
                }, function(){
                });
            }
                    
            function doViewUploader(thiz) {
                window.open($(thiz).attr('zhref'));
            }
        /*]]>*/
        </script>
        
        <!--TinyMCE-->
        <script>
            /*<![CDATA[*/
            
            //initialize editor
            function createEditor(idEditor) {
                tinymce.init({
                    selector: "textarea#"+idEditor
                        , theme: "modern"
                        , height: 1000
                        , plugins: [
                            "advlist autolink link image lists charmap print preview hr anchor pagebreak spellchecker"
                            , "searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking"
                            , "save table contextmenu directionality emoticons template paste textcolor lineheight"
                        ]
                        , toolbar: "insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | print preview media fullpage | forecolor backcolor emoticons | sizeselect | bold italic | fontselect |  fontsizeselect | lineheightselect"
                        ,lineheight_formats: "8pt 9pt 10pt 11pt 12pt 14pt 16pt 18pt 20pt 22pt 24pt 26pt 36pt"
                ,});
            }
            
            function createMinimalEditor(idEditor) {
                tinymce.init({
                    selector: "textarea#"+idEditor,
                        height: 200,
                        menubar: false,
                        statusbar: true,
                        toolbar: false
                ,});
            }
            
            /*]]>*/
        </script>
        
    <script src="chrome-extension://mooikfkahbdckldjjndioackbalphokd/assets/prompt.js"></script></head>
    
    <!--Content-->
    <body id="content" data-gr-c-s-loaded="true" style="cursor: default;">

        <!--Title-->
        <div class="panel panel-default">
            <div style="padding: 10px; font-weight: normal" class="panel-heading">
            <span>PERMIT BARANG KAWALAN BERJADUAL</span>
            <div class="note">Permohonan Pembaharuan</div>
        </div>
            <div class="panel-wrapper collapse in">
                <div class="panel-body">
            
            <!--Form-->
            <form id="myform" method="POST" class="form-horizontal" autocomplete="off">
                <input style="display: none; padding-left: 10px;" type="input" id="action" name="action">
                <textarea style="display: none; padding-left: 10px;" id="tgtBack" name="tgtBack">http://trainingb2.bless.gov.my/BLESS2_PROD_TEST/private/licLicenseRequest</textarea>

                <!--Panel-->
                <div class="form-group form-group-sm">
                    <div class="panel-group" id="accordion">

                        <!--Bahagian A-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="http://trainingb2.bless.gov.my/BLESS2_PROD_TEST/private/licKpdnkkPermitMain/renewal/374390#bahagianA">Bahagian A - Butir-Butir Pemohon/Syarikat</a></h4> 
                            </div>
                            <div id="bahagianA" class="panel-collapse collapse">
                                <div class="panel-body"> 
                                    <div class="form-group form-group-sm">
    <label class="col-md-3 control-label">No Permit/ No Siri</label>
    <div class="col-md-6">
        <input type="text" class="form-control input-sm" id="permitNo" name="permitNo" readonly="" value="P013927" style="padding-left: 10px;">
    </div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-3 control-label">Tarikh tamat tempoh permit</label>
    <div class="col-md-6">
        <input type="text" class="form-control input-sm" id="expiredDate" name="expiredDate" readonly="" value="15/03/2018" style="padding-left: 10px;">
    </div>
</div>

<div id="isIndividual" class="hide">
    <div class="form-group form-group-sm">
        <label class="col-md-3 control-label">Nama Pemohon Syarikat / Perniagaan</label>
        <div class="col-md-6">
            <input type="text" class="form-control input-sm" id="applicantName" name="applicantName" readonly="" value="HENG CHEE CHENG" style="padding-left: 10px;">
        </div>
    </div>
</div>

<div id="isCompany">
    <div class="form-group form-group-sm">
        <label class="col-md-3 control-label">Nama Organisasi</label>
        <div class="col-md-6">
            <input type="text" class="form-control input-sm" id="applicantName" name="applicantName" readonly="" value="SOON SOON OILMILLS SDN. BHD." style="padding-left: 10px;">
        </div>
    </div>
</div>

<div id="isIc" class="hide">
    <div class="form-group form-group-sm">
        <label class="col-md-3 control-label">No. Kad Pengenalan</label>
        <div class="col-md-6">
            <input type="text" class="form-control input-sm" id="applicantIcNO" name="applicantIcNO" readonly="" value="541122075265" style="padding-left: 10px;">
        </div>
    </div>
</div>

<div id="isRegNo">
    <div class="form-group form-group-sm">
        <label class="col-md-3 control-label">No Pendaftaran / No. Kad Pengenalan</label>
        <div class="col-md-6">
            <input type="text" class="form-control input-sm" id="applicantIcNO" name="applicantIcNO" readonly="" value="37441-T" style="padding-left: 10px;">
        </div>
    </div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-3 control-label">Alamat Surat Menyurat</label>
    <div class="col-sm-6">
        <textarea rows="6" readonly="" style="padding-left: 10px;">SUITE A, LEVEL 9
WAWASAN OPEN UNIVERSITY
54, JALAN SULTAN AHMAD SHAH
10050, PULAU PINANG
</textarea>
    </div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-3 control-label">Cawangan Agensi Pemprosesan</label>
    <div class="col-md-6">
        <input type="hidden" class="form-control input-sm" id="agencyId" name="agencyId" disabled="true" value="5625" style="padding-left: 10px;">
        <input class="form-control input-sm" id="agencyIdName" name="agencyIdName" disabled="true" value="MDTCC Seberang Perai" style="padding-left: 10px;">
    </div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-3 control-label required"><span>No Telefon Bimbit</span><b id="label_required_" style="color: red"> *</b></label>
    <div class="col-md-6">
        <input type="text" class="form-control input-sm numeric" maxlength="11" id="mobileNo" name="mobileNo" value="" style="padding-left: 10px;">
    </div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-3 control-label">No Telefon Pejabat</label>
    <div class="col-md-6">
        <input type="text" class="form-control input-sm numeric" maxlength="11" id="phoneNo" name="phoneNo" value="" style="padding-left: 10px;">
    </div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-3 control-label">No Faks</label>
    <div class="col-md-6">
        <input type="text" class="form-control input-sm numeric" maxlength="11" id="faxNo" name="faxNo" value="" style="padding-left: 10px;">
    </div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-3 control-label required"><span>Email</span><b id="label_required_" style="color: red"> *</b></label>
    <div class="col-md-6">
        <input type="text" class="form-control input-sm not-uppercase" maxlength="50" id="applicantEmail" name="applicantEmail" value="NGPW@SOONSOONGROUP.COM" style="padding-left: 10px;">
    </div>
</div>

<!--Bahagian A-->
<script>
/*<![CDATA[*/

            function checkApplicantType(){
                if(applicantTypeCode == "I"){
                    $('#isCompany').addClass('hide');
                    $('#isIndividual').removeClass('hide');
                    $('#isRegNo').addClass('hide');
                    $('#isIc').removeClass('hide');
                }else{
                    $('#isIndividual').addClass('hide');
                    $('#isCompany').removeClass('hide');
                    $('#isIc').addClass('hide');
                    $('#isRegNo').removeClass('hide');
                }
            }
                  
/*]]>*/
</script>
                                </div>
                            </div>
                        </div>

                        <!--Bahagian B-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="http://trainingb2.bless.gov.my/BLESS2_PROD_TEST/private/licKpdnkkPermitMain/renewal/374390#bahagianB">Bahagian B - Butir-Butir Permit yang dipohon</a></h4> 
                            </div>
                            <div id="bahagianB" class="panel-collapse collapse">
                                <div class="panel-body"> 
                                    <div class="form-group form-group-sm">
    <label class="col-md-2 control-label required"><span>Tujuan Pembelian</span><b id="label_required_" style="color: red"> *</b></label>
    <div class="col-md-4">
        <textarea class="" name="reasonBuy" id="reasonBuy" style="width: 100%; padding-left: 10px;" rows="5">FOR INTERNAL USE</textarea>
    </div>

    <div class="col-md-6">
        <div class="form-group form-group-sm">
            <label class="col-md-6 control-label required"><span>Tempoh Masa Permit diperlukan</span><b id="label_required_" style="color: red"> *</b></label>
            <label class="col-md-2 control-label">
                <span>Mula</span>
            </label>
            <div class="col-md-4">
                <div class="input-group"><input type="text" class="form-control input-sm datepicker-init hasDatepicker" id="startDate" name="startDate" value="16/03/2018" style="padding-left: 10px;"><span class="input-group-addon open-date-picker"><i class="fa fa-calendar"></i></span></div>
            </div>
        </div>

        <div class="form-group form-group-sm">
            <label class="col-md-offset-6 col-md-2 control-label">
                <span>Hingga</span>
            </label>
            <div class="col-md-4">
                <div class="input-group"><input type="text" class="form-control input-sm datepicker-init hasDatepicker" id="endDate" name="endDate" value="" style="padding-left: 10px;"><span class="input-group-addon open-date-picker"><i class="fa fa-calendar"></i></span></div>
            </div>
        </div>

        <div class="form-group form-group-sm">
            <label class="col-md-offset-8 col-md-6">
                <div class="note">Maksimum 12 bulan</div>
            </label>
        </div>
    </div>

</div>

<hr>

<div class="label-title">Jenis Barang Kawalan Bukan Bahan Petroleum</div>
<div id="itemNonPetroleumListLocation"><table id="permitItemList" class="table table-condensed table-hover">
    <tbody><tr class="info">
        <th>No</th>
        <th>Barang Kawalan</th>
        <th><div align="center">Kuantiti</div></th>
        
    </tr>
    <tr>
        
    </tr>
    
</tbody></table></div>

<div class="label-title">Jenis Barang Kawalan Bahan Petroleum</div>
<div id="itemPetroleumListLocation"><table id="itemPetroleumList" class="table table-condensed table-hover">
    <tbody><tr class="info">
        <th>No</th>
        <th>Barang Kawalan</th>
        <th><div>Jenis/Nama/Jenama/Model Jentera/Mesin/Peralatan</div></th>
        <th><div align="center">Bilangan Peralatan</div></th>
        <th><div align="center">Kapasiti Tangki ( Skid Tank ) / Silinder</div></th>
        <th><div align="center">Penggunaan Liter (Liter / Kg)</div></th>
        
    </tr>
    
    <tr>
        <td>1</td>
        <td>DIESEL (EURO 2M)</td>
        <td>FORKLIFT,FOGGING,COMPRESSOR,CUCI MESIN</td>
        <td align="center">20</td>
        <td align="middle">15900 (L)</td>
        <td align="center">7950 (L)</td>
        
    </tr>
</tbody></table></div>

<div class="label-title">Alamat Stor dan Tempat Simpanan</div>

<div class="form-group form-group-sm">
    <label class="col-md-3 control-label">Alamat Stor / Tempat Simpanan</label>
    <div class="col-sm-6">
        <textarea rows="6" readonly="" style="padding-left: 10px;">2448 LORONG PERUSAHAAN 2
PRAI INDUSTRIAL ESTATE
13600, PRAI
PULAU PINANG
MALAYSIA</textarea>
    </div>
</div>

<div id="storAddressListLocation"><table id="storAddressList" class="table table-condensed table-hover">
    <tbody><tr class="info">
        <th>No</th>
        <th>Barang Kawalan</th>
<!--        <th><div align="center" th:text="#{LicKpdnkkPermitMain.b_stor_storage}"></div></th>-->
        <th><div align="center">Kuantiti Simpanan</div></th>
        
    </tr>
    
    <tr>
        <td>1</td>
        <td>DIESEL (EURO 2M)</td>
<!--        <td th:text="${data.address}"></td>-->
        <td align="center">15900 (L)</td>
        
    </tr>
    <tr>
        <td>2</td>
        <td>DIESEL (EURO 2M)</td>
<!--        <td th:text="${data.address}"></td>-->
        <td align="center">15900 (L)</td>
        
    </tr>
</tbody></table></div>

<!--Bahagian B-->
<script>
    /*<![CDATA[*/
    var active_item_id = "";

    function loadNonPetroleumItemList() {
        $.ajax({
            url: context + "licKpdnkkPermitItem/ajax/loadNonPetroleumItemListRenewal/" + permitMainId,
            method: "GET",
            success: function (data) {
                $("#itemNonPetroleumListLocation").html(data);
                checklist_nonitem();

                var ptr = $("#itemNonPetroleumListLocation").find("tr");
                ptr.find("td:last").remove();
                ptr.find("th:last").remove();
            }
        });
    }

    function loadPetroleumItemList() {
        $.ajax({
            url: context + "licKpdnkkPermitPetroleumItem/ajax/loadPetroleumItemListRenewal/" + permitMainId,
            method: "GET",
            success: function (data) {
                $("#itemPetroleumListLocation").html(data);
                checklist_item();

                var ptr = $("#itemPetroleumListLocation").find("tr");
                ptr.find("td:last").remove();
                ptr.find("th:last").remove();
            },
            complete: function () {
                checkForCustomDocumentMandatory();
            }
        });
    }

    function loadStorAddressList() {
        $.ajax({
            url: context + "licKpdnkkPermitItemStore/ajax/loadItemStoreListRenewal/" + permitMainId,
            method: "GET",
            success: function (data) {
                $("#storAddressListLocation").html(data);
                checklist_store();

                var ptr = $("#storAddressListLocation").find("tr");
                ptr.find("td:last").remove();
                ptr.find("th:last").remove();
            }
        });
    }

    $("#startDate, #endDate").change(function () {
        var startDate = $("#startDate").val();
        var endDate = $("#endDate").val();

        if (endDate != "" && startDate != "") {
            var addMonth = addMonthToDate(startDate, 12);
            var isBefore = date2IsBeforeDate1(addMonth, endDate);

            if (!isBefore) {
                $("#endDate").val(addMonth);
            }

        } else if (endDate == "" && startDate != "") {
            var addMonth = addMonthToDate(startDate, 12);
            $("#endDate").val(addMonth);
        }

    });

    $('#endDate').click(function () {
        var startDate = $("#startDate").val();
        var endDate = $("#endDate").val();

        if (endDate == "" && startDate != "") {
            var addMonth = addMonthToDate(startDate, 12);
            $("#endDate").val(addMonth);
            $('#endDate').datepicker('option', 'minDate', startDate);
        }
        $('#endDate').datepicker('option', 'minDate', startDate);
    });

    /*]]>*/
</script>
                                </div>
                            </div>
                        </div>

                        <!--Bahagian C-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="http://trainingb2.bless.gov.my/BLESS2_PROD_TEST/private/licKpdnkkPermitMain/renewal/374390#bahagianC">Bahagian C - Butir-butir Syarikat Pembekal</a></h4> 
                            </div>
                            <div id="bahagianC" class="panel-collapse collapse">
                                <div class="panel-body"> 
                                    <div class="label-title">Maklumat Lengkap Syarikat Pembekal</div>

<div id="itemSupplierListLocation"><table id="b_table" class="table table-hover table-condensed">
    <tbody><tr class="info">
        <th>No</th>
        <th>Barang Kawalan</th>
        <th>No. Lesen Barang Kawalan</th>
        <th>Tarikh Tamat</th>
        <th>Nama Syarikat Pembekal</th>
        <th>Alamat Syarikat Pembekal</th>
        <th>No Pendaftaran Syarikat</th>
        
    </tr>
    
    <tr>
        <td>1</td>
        <td>Diesel (Euro 2M)</td>
        <td>-</td>
        <td></td>
        <td>PETRONAS DAGANGAN BERHAD</td>
        <td>LOT 93 KAWALAN PERUSAHAAN PRAI, KAWASAN PERUSAHAAN BEBAS PERAI, 13600, PRAI, PULAU PINANG</td>
        <td>37441-T</td>
        
    </tr>
</tbody></table></div>

<!--Bahagian C-->
<script>
    /*<![CDATA[*/
        var prevPermitMainId = 7357;
        
        
        function loadItemSupplierList(){
            $.ajax({
               url: context + "licKpdnkkPermitItemSupplier/ajax/loadPermitSupplierList/" + permitMainId,
               method: "GET",
               success: function(data){
                    $("#itemSupplierListLocation").html(data);
                    checklist_supplier();

                    var ptr = $("#itemSupplierListLocation").find("tr");
                    ptr.find("td:last").remove();
                    ptr.find("th:last").remove();
               }
            });
        }
    /*]]>*/
</script>
                                </div>
                            </div>
                        </div>

                        <!--Bahagian D-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="http://trainingb2.bless.gov.my/BLESS2_PROD_TEST/private/licKpdnkkPermitMain/renewal/374390#bahagianD">Bahagian D - Butir-Butir Lesen/Kelulusan daripada Jabatan/Agensi</a></h4> 
                            </div>
                            <div id="bahagianD" class="panel-collapse collapse ">
                                <div class="panel-body"> 
                                    <div class="form-group form-group-sm">
    <div class="col-md-12 label-title">Bahagian D - Butir-Butir Lesen/Kelulusan daripada Jabatan/Agensi</div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-4 control-label" id="label_referenceNo1"><span>Kelulusan Jabatan Bomba dan Penyelamat Malaysia</span><b id="label_required_label_referenceNo1" style="color: red"> *</b></label>
    <div class="radio-list" align="right">
        <label class="radio-inline col-md-2">
            <div class="radio radio-info col-md-6">
                <input type="radio" name="isHasReferenceNo1" id="bombaY" value="1" checked="checked" style="padding-left: 10px;">
                <label for="bombaY">Ada</label> 
            </div>
            <div class="radio radio-info col-md-6">
                <input type="radio" name="isHasReferenceNo1" id="bombaN" value="0" style="padding-left: 10px;">
                <label for="bombaN">Tiada</label>
            </div>
        </label>
    </div>
    <label class="col-md-1 control-label">
        <span>No. Rujukan</span>
    </label>
    <div id="divBomba" class="col-md-4">
        <input type="text" maxlength="50" class="form-control input-sm" id="fireReferenceNo" name="fireReferenceNo" value="JBPM:PP/ZPI:700-5/1/20/443" style="padding-left: 10px;">
    </div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-4 control-label">Kebenaran di bawah Akta Kemajuan Petroleum 1974 (PDA)</label>
    <label class="col-md-3 control-label">
        <span>No. Rujukan</span>
    </label>
    <div class="col-md-4">
        <input type="text" maxlength="50" class="form-control input-sm" id="pdaReferenceNo" name="pdaReferenceNo" value="" style="padding-left: 10px;">
    </div>
</div>    

<div class="form-group form-group-sm">
    <label class="col-md-4 control-label">Kelulusan Pihak Berkuasa/Majlis Kerajaan Tempatan</label>
    <label class="col-md-3 control-label">No. Rujukan</label>
    <div class="col-md-4">
        <input type="text" maxlength="50" class="form-control input-sm " id="pbtReferenceNo" name="pbtReferenceNo" value="" style="padding-left: 10px;">
    </div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-offset-4 col-md-3 control-label">No. Lesen</label>
    <div class="col-md-4">
        <input type="text" class="form-control input-sm" id="pbtLicenseNo" name="pbtLicenseNo" value="" style="padding-left: 10px;">
    </div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-offset-4 col-md-3 control-label">Tarikh Luput</label>
    <div class="col-md-4">
        <div class="input-group"><input type="text" class="form-control input-sm datepicker-init hasDatepicker" id="pbtExpiryDate" name="pbtExpiryDate" value="" style="padding-left: 10px;"><span class="input-group-addon open-date-picker"><i class="fa fa-calendar"></i></span></div>
    </div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-12 label-title">Surat/Kelulusan Dari Jabatan/Agensi Lain</label>
</div>

<div class="form-group form-group-sm">
    <button id="btnAddAgency" type="button" class="btn btn-primary">Add</button>
</div>

<div id="agencyListLocation"><table id="csaAgencyList" class="table table-condensed">
    <tbody><tr class="info">
        <th>No</th>
        <th>Jabatan/Agensi</th>
        <th>No. Rujukan Fail</th>
        <th>Action</th>
    </tr>
    <tr>
        <td align="middle" colspan="5">No Record Found</td>
    </tr>
    
</tbody></table></div>

<!--Bahagian D-->
<script>
    /*<![CDATA[*/
    
    $("#bombaY, #bombaN").change(function(){
        checkIsHasReferenceNo1();
        checkForCustomDocumentMandatory();
    });
    
    function checkIsHasReferenceNo1(){
        var is_has_reference_no_1 = $("#bombaY").is(':checked');
        if(is_has_reference_no_1) {
            $("#fireReferenceNo").prop('readonly', false);
            
            labelAsRequired($("#label_referenceNo1"));
        } else {
            $("#fireReferenceNo").prop('readonly', true);
            $("#fireReferenceNo").val('');
            
            $("#label_required_label_referenceNo1").remove();
        }
    }
            
            function loadAgency(){
                $.ajax({
                   url: context + "licKpdnkkPermitAgency/ajax/loadPermitAgency/" + permitMainId,
                   method: "GET",
                   success: function(listHtml) {
                       $("#agencyListLocation").html(listHtml);
                       checklist_agency();
                       
                       $(".btnDeleteAgency").click(function(){
                            var agencyId = this.id;
                            
                            alertCallbackYN('Are you sure to delete data?', 'Record(s) will be permanently deleted.', '', function(){
                                
                                $.ajax({
                                    url: context + "licKpdnkkPermitAgency/ajax/delete/" + agencyId,
                                    method: "GET",
                                    success: function(){
                                        loadAgency();
                                    }
                                })
                                
                            }, function(){
                            });
                            
                       });
                   }
                });
            }
            
            $("#btnAddAgency").click(function () {
                loadAgencyFormModal();
            })
            
            function loadAgencyFormModal(){
                $.ajax({
                    url: context + "licKpdnkkPermitAgency/ajax/loadPermitAgencyFormModal",
                    method: "GET",
                    success: function(formHtml){
                        $("#agencyFormModalLocation").html(formHtml);
                        customSetup();
                        $("#agencyFormModal").modal("show");
                        
                        $("#btnSaveAgency").click(function(){
                            var agencyFormValidation = validateForm([
                                {id: "name", message: "'Jabatan/Agensi'"},
                                {id: "fileNo", message: "'No. Rujukan Fail'"}
                            ], "agencyForm");
                            
                            if(agencyFormValidation == 0) {
                                $.ajax({
                                    url: context + "licKpdnkkPermitAgency/ajax/add/" + permitMainId,
                                    method: "POST",
                                    data: $("#agencyForm").serialize(),
                                    success: function(){
                                        $("#agencyFormModal").modal("hide");
                                        loadAgency();
                                    }
                                });
                            }
                        });
                    }
                })
            }
    /*]]>*/
</script>
                                </div>
                            </div>
                        </div>
                        
                        <!--Bahagian E - Senarai Semak-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="http://trainingb2.bless.gov.my/BLESS2_PROD_TEST/private/licKpdnkkPermitMain/renewal/374390#checklist">Bahagian E - Senarai Semak</a></h4> 
                            </div>
                            <div id="checklist" class="panel-collapse collapse">
                                <div class="panel-body"> 
                                    <div class="form-group form-group-sm">
    <div><table style="vertical-align: middle;" id="documentChecklistTable" class="table table-condensed table-hover">
        
        <tbody><tr class="info">
            <th colspan="3">Bahagian I - Melengkapkan Butir-Butir Pemohonan</th>
            <th width="10%"><center>Ada&nbsp;&nbsp;</center></th>
            <th width="10%"><center>Tiada&nbsp;&nbsp;</center></th>
        </tr>
        
        <tr>
            <td></td>
            <td align="middle">1</td>
            <td>Nama Pemohon/Syarikat/Perniagaan</td>
            <td align="middle">
                <div class="radio radio-success">
                    <input type="radio" disabled="" checked="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
            <td align="middle">
                <div class="radio radio-danger">
                    <input type="radio" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
        </tr>
        
        <tr>
            <td></td>
            <td align="middle">2</td>
            <td>Bentuk Perniagaan</td>
            <td align="middle">
                <div class="radio radio-success">
                    <input type="radio" id="bussinessType_checkY" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
            <td align="middle">
                <div class="radio radio-danger">
                    <input type="radio" id="bussinessType_checkN" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
        </tr>
        
        <tr>
            <td></td>
            <td align="middle">3</td>
            <td>No. Pendaftaran/Kad Pengenalan</td>
            <td align="middle">
                <div class="radio radio-success">
                    <input type="radio" disabled="" checked="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
            <td align="middle">
                <div class="radio radio-danger">
                    <input type="radio" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
        </tr>
        
        <tr>
            <td></td>
            <td align="middle">4</td>
            <td>Aktiviti Yang Dijalankan</td>
            <td align="middle">
                <div class="radio radio-success">
                    <input type="radio" id="implActivity_checkY" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
            <td align="middle">
                <div class="radio radio-danger">
                    <input type="radio" id="implActivity_checkN" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
        </tr>
        
        <tr>
            <td></td>
            <td align="middle">5</td>
            <td>Alamat Premis Perniagaan</td>
            <td align="middle">
                <div class="radio radio-success">
                    <input type="radio" checked="" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
            <td align="middle">
                <div class="radio radio-danger">
                    <input type="radio" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
        </tr>
        
        <tr>
            <td></td>
            <td align="middle">6</td>
            <td>No. Telefon</td>
            <td align="middle">
                <div class="radio radio-success">
                    <input type="radio" id="phoneNo_checkY" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
            <td align="middle">
                <div class="radio radio-danger">
                    <input type="radio" id="phoneNo_checkN" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
        </tr>
        
        <tr>
            <td></td>
            <td align="middle">7</td>
            <td>No. Telefon Bimbit</td>
            <td align="middle">
                <div class="radio radio-success">
                    <input type="radio" id="mobileNo_checkY" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
            <td align="middle">
                <div class="radio radio-danger">
                    <input type="radio" id="mobileNo_checkN" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
        </tr>
        
        <tr>
            <td></td>
            <td align="middle">8</td>
            <td>No. Faksimili</td>
            <td align="middle">
                <div class="radio radio-success">
                    <input type="radio" id="faxNo_checkY" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
            <td align="middle">
                <div class="radio radio-danger">
                    <input type="radio" id="faxNo_checkN" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
        </tr>
        
        <tr>
            <td></td>
            <td align="middle">9</td>
            <td>Emel</td>
            <td align="middle">
                <div class="radio radio-success">
                    <input type="radio" id="applicantEmail_checkY" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
            <td align="middle">
                <div class="radio radio-danger">
                    <input type="radio" id="applicantEmail_checkN" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
        </tr>
        
        <tr class="info">
            <th colspan="5">Bahagian II - Melengkapkan Butir-Butir Lesen</th>
        </tr>
        
        <tr>
            <td></td>
            <td align="middle">1</td>
            <td>Jenis Barang Kawalan</td>
            <td align="middle">
                <div class="radio radio-success">
                    <input type="radio" id="deletenonitem_checkY" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
            <td align="middle">
                <div class="radio radio-danger">
                    <input type="radio" id="deletenonitem_checkN" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
        </tr>
        
        <tr>
            <td></td>
            <td align="middle">2</td>
            <td>Tujuan Pembelian</td>
            <td align="middle">
                <div class="radio radio-success">
                    <input type="radio" id="reasonBuy_checkY" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
            <td align="middle">
                <div class="radio radio-danger">
                    <input type="radio" id="reasonBuy_checkN" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
        </tr>
        
        <tr>
            <td></td>
            <td align="middle">3</td>
            <td>Barang Kawalan Bahan Petroleum</td>
            <td align="middle">
                <div class="radio radio-success">
                    <input type="radio" id="deleteitem_checkY" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
            <td align="middle">
                <div class="radio radio-danger">
                    <input type="radio" id="deleteitem_checkN" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
        </tr>
        
        <tr>
            <td></td>
            <td align="middle">4</td>
            <td>Tempoh Masa Permit Diperlukan</td>
            <td align="middle">
                <div class="radio radio-success">
                    <input type="radio" id="endDate_checkY" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
            <td align="middle">
                <div class="radio radio-danger">
                    <input type="radio" id="endDate_checkN" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
        </tr>
        
        <tr>
            <td></td>
            <td align="middle">5</td>
            <td>Alamat Stor/Tempat Simpanan</td>
            <td align="middle">
                <div class="radio radio-success">
                    <input type="radio" id="deleteitemstore_checkY" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
            <td align="middle">
                <div class="radio radio-danger">
                    <input type="radio" id="deleteitemstore_checkN" disabled="" style="padding-left: 10px;"><label></label>
                </div>
            </td>
        </tr>
        
        <tr class="info">
            <th colspan="3">Bahagian III - Butir-Butir Syarikat Pembekal</th>
            <th align="middle">
                <center>
                    <div class="radio radio-success">
                        <input type="radio" id="deletepermitsupplier_checkY" disabled="" style="padding-left: 10px;"><label></label>
                    </div>
                </center>
            </th>
            <th align="middle">
                <center>
                    <div class="radio radio-danger">
                        <input type="radio" id="deletepermitsupplier_checkN" disabled="" style="padding-left: 10px;"><label></label>
                    </div>
                </center>
            </th>
        </tr>
        
        <tr class="info">
            <th colspan="3">Bahagian IV - Butir-Butir Lesen/ Kelulusan Daripada Jabatan/ Agensi Berkaitan</th>
            <th align="middle">
                <center>
                    <div class="radio radio-success">
                        <input type="radio" id="deleteagency_checkY" disabled="" style="padding-left: 10px;"><label></label>
                    </div>
                </center>
            </th>
            <th align="middle">
                <center>
                    <div class="radio radio-danger">
                        <input type="radio" id="deleteagency_checkN" disabled="" style="padding-left: 10px;"><label></label>
                    </div>
                </center>
            </th>
        </tr>
        
<!--        <tr class="info">
            <th colspan="5" th:text="#{LicKpdnkkPermitMain.e_document}"></th>
        </tr>-->
        
<!--        <tr th:each="document, i : ${documentList}">
            <td></td>
            <td align="middle"></td>
            <td>
                <div class="form-group">
                    <span th:id="${document.code} + '_label_span'" 
                          style="text-align: justify; width: 100%" 
                          th:class="${document.isMandatory} ? 'col-md-8 control-label required' : 'col-md-8 control-label'" 
                          th:text="${document.description}"/>
                </div>
            </td>
            <td align="middle">
                <input class="applicantNameCheck" name='documentCheckYes' id="documentCheckYes" type="radio" />
            </td>
            <td align="middle">
                <input class="applicantNameCheck" name='documentCheckNo' id="documentCheckNo" type="radio" />
            </td>
        </tr>-->
        
        <tr class="info">
            <th colspan="3">Bahagian V -  Perakuan</th>
            <th>
                <center>
                    <div class="radio radio-success">
                        <input type="radio" id="isAgree_checkY" disabled="" style="padding-left: 10px;"><label></label>
                    </div>
                </center>
            </th>
            <th>
                <center>
                    <div class="radio radio-danger">
                        <input type="radio" id="isAgree_checkN" disabled="" style="padding-left: 10px;"><label></label>
                    </div>
                </center>
            </th>
        </tr>

    </tbody></table></div>
</div>

<script>
    /*<![CDATA[*/
    
    function checklist(){
        $("input, select, textarea").each(function(){
            var id = this.id;
            var type = $("#" + this.id).prop('type');

            if($(this).is("input") || $(this).is("textarea")) {
                if(type == "checkbox") {
                    var checked = $("#" + this.id).is(":checked");
                    if(checked) {
                        $("#" + this.id + "_checkY").prop('checked', true);
                        $("#" + this.id + "_checkN").prop('checked', false);
                    } else {
                        $("#" + this.id + "_checkY").prop('checked', false);
                        $("#" + this.id + "_checkN").prop('checked', true);
                    }
                } else {
                    var value = this.value.replace(" ", "");
                    if(value == "") {
                        $("#" + this.id + "_checkY").prop('checked', false);
                        $("#" + this.id + "_checkN").prop('checked', true);
                    } else {
                        $("#" + this.id + "_checkY").prop('checked', true);
                        $("#" + this.id + "_checkN").prop('checked', false);
                    }
                }

            } else if($(this).is("select")) {
                var value = $(this).select2("val");
                if(value == "") {
                    $("#" + this.id + "_checkY").prop('checked', false);
                    $("#" + this.id + "_checkN").prop('checked', true);
                } else {
                    $("#" + this.id + "_checkY").prop('checked', true);
                    $("#" + this.id + "_checkN").prop('checked', false);
                }
            }
        });

    }
            
    function checklist_nonitem(){

        var count_deletenonitem = 0;
        $(".btnDeleteNonItem").each(function(){
            count_deletenonitem++;
        });
        if(count_deletenonitem === 0) {
            $("#deletenonitem_checkY").prop('checked', false);
            $("#deletenonitem_checkN").prop('checked', true);
        } else {
            $("#deletenonitem_checkY").prop('checked', true);
            $("#deletenonitem_checkN").prop('checked', false);
        }
        
    }
    
    function checklist_item(){

        var count_deleteitem = 0;
        $(".btnDeleteItem").each(function(){
            count_deleteitem++;
        });
        if(count_deleteitem === 0) {
            $("#deleteitem_checkY").prop('checked', false);
            $("#deleteitem_checkN").prop('checked', true);
        } else {
            $("#deleteitem_checkY").prop('checked', true);
            $("#deleteitem_checkN").prop('checked', false);
        }
        
        return count_deleteitem;
        
    }

    function checklist_store(){
        
        var count_deleteitemstore = 0;
        $(".btnDeleteItemStore").each(function(){
            count_deleteitemstore++;
        });
        if(count_deleteitemstore === 0) {
            $("#deleteitemstore_checkY").prop('checked', false);
            $("#deleteitemstore_checkN").prop('checked', true);
        } else {
            $("#deleteitemstore_checkY").prop('checked', true);
            $("#deleteitemstore_checkN").prop('checked', false);
        }
    }
    
    function checklist_supplier(){

        var count_deletepermitsupplier = 0;
        $(".btnDeletePermitSupplier").each(function(){
            count_deletepermitsupplier++;
        });
        if(count_deletepermitsupplier === 0) {
            $("#deletepermitsupplier_checkY").prop('checked', false);
            $("#deletepermitsupplier_checkN").prop('checked', true);
        } else {
            $("#deletepermitsupplier_checkY").prop('checked', true);
            $("#deletepermitsupplier_checkN").prop('checked', false);
        }
    }

    function checklist_agency(){
        var count_deleteagency = 0;
        $(".btnDeleteAgency").each(function(){
            count_deleteagency++;
        });
        if(count_deleteagency === 0) {
            $("#deleteagency_checkY").prop('checked', false);
            $("#deleteagency_checkN").prop('checked', true);
        } else {
            $("#deleteagency_checkY").prop('checked', true);
            $("#deleteagency_checkN").prop('checked', false);
        }

    }
    
    /*]]>*/
</script>
                                </div>
                            </div>
                        </div>

                        <!--Dokumen/Checklist-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="http://trainingb2.bless.gov.my/BLESS2_PROD_TEST/private/licKpdnkkPermitMain/renewal/374390#bahagianDocument">Bahagian F - Dokumen Sokongan</a></h4> 
                            </div>
                            <div id="bahagianDocument" class="panel-collapse collapse">
                                <div class="panel-body"> 
                                    <div class="form-group form-group-sm">
    <h4>Attach Document:</h4>
    <p class="text-muted m-b-30 font-13">
        <span>Maximum number of file that can be uploaded is 20 files for one submission.</span><br>
        <span>Please:</span><br>
        <span>1. Compress the files if more than 20 files need to be uploaded;</span><br>
        <span>2. Combine small files together because the capacity of one file is 5 megabytes</span><br>
        <span>3. Send only required supporting documents</span><br>
    </p>
</div>

<div class="form-group form-group-sm">
    <div><table id="documentChecklistTable" class="table table-condensed table-striped">
        <tbody><tr>
            <td class="documentChecklist_count" width="5%" value="1">1</td>
            <td width="50%">
                <div class="form-group form-group-sm">
                    <span style="text-align: justify; width: 100%" id="KPDN013RNW170001_label_span" class="col-md-8 control-label required"><span>Permit asal.</span><b id="label_required_KPDN013RNW170001_label_span" style="color: red"> *</b></span>
                </div>
            </td>
            <!-- <td width='10%'>
                <div th:if="${document.isDisplaySoftcopyOption}" class="checkbox checkbox-primary">
                    <input th:id="${document.code} + '_softcopy'" th:name="${document.code} + '_softcopy'" 
                           type="checkbox" th:checked="${document.isSoftcopy OR document.isMandatory}"
                           th:attr="mandatory=${document.isMandatory}"/>
                    <label th:for="${document.code} + '_softcopy'"  th:text="#{general.softcopy}"></label>
                </div>
            </td>-->
            <td width="10%">
                <div class="checkbox checkbox-primary">
                    <input type="checkbox" onchange="enableDisableUploadBtn(this);" mandatory="true" id="KPDN013RNW170001_softcopy" name="KPDN013RNW170001_softcopy" checked="checked" style="padding-left: 10px;">
                    <label for="KPDN013RNW170001_softcopy">Softcopy</label>
                </div>
            </td>
            <td width="10%">
                
            </td>
            <td width="20%">
                <div class="form-group form-group-sm">
                    <div id="uploadFile">

            <div class="btn-group">
                <div class="pull-left">
                    <table style="width:100%">
                        <tbody><tr>
                            <td>
                                <button type="button" class="btn btn-sm btn-primary btnUpload" id="btnKPDN013RNW170001_374390">Upload</button>
                                <input type="file" name="file" style="display: none; padding-left: 10px;" id="KPDN013RNW170001_374390">
                            </td>
                            <td style="padding-left: 10px">
                                <div class="label" style="color: blue; padding: 10px; display: none;" id="infoKPDN013RNW170001_374390">
                                    <center>
                                        <i class="fa fa-gear fa-4x fa-spin"></i><br>
                                        Store file in processing..<br> Please wait.. 
                                    </center>
                                </div>
                                <progress value="3" max="100" id="progressKPDN013RNW170001_374390" style="display: none;"></progress>
                            </td>
                            <td style="padding-left: 10px" id="descKPDN013RNW170001_374390"></td>
                        </tr>
                    </tbody></table>

                </div>

                <br>
                <div class="" id="divKPDN013RNW170001_374390"></div>
            </div>

            <script>
                /*<![CDATA[*/
                var prefix= 'KPDN013';
                var referenceId= 'KPDN013RNW170001_374390';
                var contextPath = '/BLESS2_PROD_TEST';
                var allowContentType = null;
                
                var upload_confirmation = null;
                var upload_confirmationTitle = null;
                var upload_confirmationContent = null;
                
                file_uploader(contextPath, 'private', prefix, referenceId, allowContentType, upload_confirmation);
                /*]]>*/
            </script>
        </div>
                </div>
            </td>
        </tr>
        <tr>
            <td class="documentChecklist_count" width="5%" value="2">2</td>
            <td width="50%">
                <div class="form-group form-group-sm">
                    <span style="text-align: justify; width: 100%" id="KPDN013RNW170002_label_span" class="col-md-8 control-label">Surat Lantikan Konsultant (Jika berkaitan)
</span>
                </div>
            </td>
            <!-- <td width='10%'>
                <div th:if="${document.isDisplaySoftcopyOption}" class="checkbox checkbox-primary">
                    <input th:id="${document.code} + '_softcopy'" th:name="${document.code} + '_softcopy'" 
                           type="checkbox" th:checked="${document.isSoftcopy OR document.isMandatory}"
                           th:attr="mandatory=${document.isMandatory}"/>
                    <label th:for="${document.code} + '_softcopy'"  th:text="#{general.softcopy}"></label>
                </div>
            </td>-->
            <td width="10%">
                <div class="checkbox checkbox-primary">
                    <input type="checkbox" onchange="enableDisableUploadBtn(this);" mandatory="false" id="KPDN013RNW170002_softcopy" name="KPDN013RNW170002_softcopy" style="padding-left: 10px;">
                    <label for="KPDN013RNW170002_softcopy">Softcopy</label>
                </div>
            </td>
            <td width="10%">
                <div class="checkbox checkbox-primary">
                    <input type="checkbox" id="KPDN013RNW170002_hardcopy" name="KPDN013RNW170002_hardcopy" style="padding-left: 10px;">
                    <label for="KPDN013RNW170002_hardcopy">Hardcopy</label>
                </div>
            </td>
            <td width="20%">
                <div class="form-group form-group-sm">
                    <div id="uploadFile">

            <div class="btn-group">
                <div class="pull-left">
                    <table style="width:100%">
                        <tbody><tr>
                            <td>
                                <button type="button" class="btn btn-sm btn-primary btnUpload" disabled="" id="btnKPDN013RNW170002_374390">Upload</button>
                                <input type="file" name="file" style="display: none; padding-left: 10px;" id="KPDN013RNW170002_374390">
                            </td>
                            <td style="padding-left: 10px">
                                <div class="label" style="color: blue; padding: 10px; display: none;" id="infoKPDN013RNW170002_374390">
                                    <center>
                                        <i class="fa fa-gear fa-4x fa-spin"></i><br>
                                        Store file in processing..<br> Please wait.. 
                                    </center>
                                </div>
                                <progress value="3" max="100" id="progressKPDN013RNW170002_374390" style="display: none;"></progress>
                            </td>
                            <td style="padding-left: 10px" id="descKPDN013RNW170002_374390"></td>
                        </tr>
                    </tbody></table>

                </div>

                <br>
                <div class="" id="divKPDN013RNW170002_374390"></div>
            </div>

            <script>
                /*<![CDATA[*/
                var prefix= 'KPDN013';
                var referenceId= 'KPDN013RNW170002_374390';
                var contextPath = '/BLESS2_PROD_TEST';
                var allowContentType = null;
                
                var upload_confirmation = null;
                var upload_confirmationTitle = null;
                var upload_confirmationContent = null;
                
                file_uploader(contextPath, 'private', prefix, referenceId, allowContentType, upload_confirmation);
                /*]]>*/
            </script>
        </div>
                </div>
            </td>
        </tr>
        <tr>
            <td class="documentChecklist_count" width="5%" value="3">3</td>
            <td width="50%">
                <div class="form-group form-group-sm">
                    <span style="text-align: justify; width: 100%" id="KPDN013RNW170003_label_span" class="col-md-8 control-label">Salinan kad pengenalan bagi individu (Bagi pihak konsultant)
</span>
                </div>
            </td>
            <!-- <td width='10%'>
                <div th:if="${document.isDisplaySoftcopyOption}" class="checkbox checkbox-primary">
                    <input th:id="${document.code} + '_softcopy'" th:name="${document.code} + '_softcopy'" 
                           type="checkbox" th:checked="${document.isSoftcopy OR document.isMandatory}"
                           th:attr="mandatory=${document.isMandatory}"/>
                    <label th:for="${document.code} + '_softcopy'"  th:text="#{general.softcopy}"></label>
                </div>
            </td>-->
            <td width="10%">
                <div class="checkbox checkbox-primary">
                    <input type="checkbox" onchange="enableDisableUploadBtn(this);" mandatory="false" id="KPDN013RNW170003_softcopy" name="KPDN013RNW170003_softcopy" style="padding-left: 10px;">
                    <label for="KPDN013RNW170003_softcopy">Softcopy</label>
                </div>
            </td>
            <td width="10%">
                
            </td>
            <td width="20%">
                <div class="form-group form-group-sm">
                    <div id="uploadFile">

            <div class="btn-group">
                <div class="pull-left">
                    <table style="width:100%">
                        <tbody><tr>
                            <td>
                                <button type="button" class="btn btn-sm btn-primary btnUpload" disabled="" id="btnKPDN013RNW170003_374390">Upload</button>
                                <input type="file" name="file" style="display: none; padding-left: 10px;" id="KPDN013RNW170003_374390">
                            </td>
                            <td style="padding-left: 10px">
                                <div class="label" style="color: blue; padding: 10px; display: none;" id="infoKPDN013RNW170003_374390">
                                    <center>
                                        <i class="fa fa-gear fa-4x fa-spin"></i><br>
                                        Store file in processing..<br> Please wait.. 
                                    </center>
                                </div>
                                <progress value="3" max="100" id="progressKPDN013RNW170003_374390" style="display: none;"></progress>
                            </td>
                            <td style="padding-left: 10px" id="descKPDN013RNW170003_374390"></td>
                        </tr>
                    </tbody></table>

                </div>

                <br>
                <div class="" id="divKPDN013RNW170003_374390"></div>
            </div>

            <script>
                /*<![CDATA[*/
                var prefix= 'KPDN013';
                var referenceId= 'KPDN013RNW170003_374390';
                var contextPath = '/BLESS2_PROD_TEST';
                var allowContentType = null;
                
                var upload_confirmation = null;
                var upload_confirmationTitle = null;
                var upload_confirmationContent = null;
                
                file_uploader(contextPath, 'private', prefix, referenceId, allowContentType, upload_confirmation);
                /*]]>*/
            </script>
        </div>
                </div>
            </td>
        </tr>
        <tr>
            <td class="documentChecklist_count" width="5%" value="4">4</td>
            <td width="50%">
                <div class="form-group form-group-sm">
                    <span style="text-align: justify; width: 100%" id="KPDN013RNW170004_label_span" class="col-md-8 control-label">Lesen Pihak Berkuasa Tempatan/Majlis (Jika ada)
</span>
                </div>
            </td>
            <!-- <td width='10%'>
                <div th:if="${document.isDisplaySoftcopyOption}" class="checkbox checkbox-primary">
                    <input th:id="${document.code} + '_softcopy'" th:name="${document.code} + '_softcopy'" 
                           type="checkbox" th:checked="${document.isSoftcopy OR document.isMandatory}"
                           th:attr="mandatory=${document.isMandatory}"/>
                    <label th:for="${document.code} + '_softcopy'"  th:text="#{general.softcopy}"></label>
                </div>
            </td>-->
            <td width="10%">
                <div class="checkbox checkbox-primary">
                    <input type="checkbox" onchange="enableDisableUploadBtn(this);" mandatory="false" id="KPDN013RNW170004_softcopy" name="KPDN013RNW170004_softcopy" style="padding-left: 10px;">
                    <label for="KPDN013RNW170004_softcopy">Softcopy</label>
                </div>
            </td>
            <td width="10%">
                
            </td>
            <td width="20%">
                <div class="form-group form-group-sm">
                    <div id="uploadFile">

            <div class="btn-group">
                <div class="pull-left">
                    <table style="width:100%">
                        <tbody><tr>
                            <td>
                                <button type="button" class="btn btn-sm btn-primary btnUpload" disabled="" id="btnKPDN013RNW170004_374390">Upload</button>
                                <input type="file" name="file" style="display: none; padding-left: 10px;" id="KPDN013RNW170004_374390">
                            </td>
                            <td style="padding-left: 10px">
                                <div class="label" style="color: blue; padding: 10px; display: none;" id="infoKPDN013RNW170004_374390">
                                    <center>
                                        <i class="fa fa-gear fa-4x fa-spin"></i><br>
                                        Store file in processing..<br> Please wait.. 
                                    </center>
                                </div>
                                <progress value="3" max="100" id="progressKPDN013RNW170004_374390" style="display: none;"></progress>
                            </td>
                            <td style="padding-left: 10px" id="descKPDN013RNW170004_374390"></td>
                        </tr>
                    </tbody></table>

                </div>

                <br>
                <div class="" id="divKPDN013RNW170004_374390"></div>
            </div>

            <script>
                /*<![CDATA[*/
                var prefix= 'KPDN013';
                var referenceId= 'KPDN013RNW170004_374390';
                var contextPath = '/BLESS2_PROD_TEST';
                var allowContentType = null;
                
                var upload_confirmation = null;
                var upload_confirmationTitle = null;
                var upload_confirmationContent = null;
                
                file_uploader(contextPath, 'private', prefix, referenceId, allowContentType, upload_confirmation);
                /*]]>*/
            </script>
        </div>
                </div>
            </td>
        </tr>
        <tr>
            <td class="documentChecklist_count" width="5%" value="5">5</td>
            <td width="50%">
                <div class="form-group form-group-sm">
                    <span style="text-align: justify; width: 100%" id="KPDN013RNW170005_label_span" class="col-md-8 control-label">Gambar peralatan atau lain-lain dokumen berkaitan.(Jika perlu)
</span>
                </div>
            </td>
            <!-- <td width='10%'>
                <div th:if="${document.isDisplaySoftcopyOption}" class="checkbox checkbox-primary">
                    <input th:id="${document.code} + '_softcopy'" th:name="${document.code} + '_softcopy'" 
                           type="checkbox" th:checked="${document.isSoftcopy OR document.isMandatory}"
                           th:attr="mandatory=${document.isMandatory}"/>
                    <label th:for="${document.code} + '_softcopy'"  th:text="#{general.softcopy}"></label>
                </div>
            </td>-->
            <td width="10%">
                <div class="checkbox checkbox-primary">
                    <input type="checkbox" onchange="enableDisableUploadBtn(this);" mandatory="false" id="KPDN013RNW170005_softcopy" name="KPDN013RNW170005_softcopy" style="padding-left: 10px;">
                    <label for="KPDN013RNW170005_softcopy">Softcopy</label>
                </div>
            </td>
            <td width="10%">
                
            </td>
            <td width="20%">
                <div class="form-group form-group-sm">
                    <div id="uploadFile">

            <div class="btn-group">
                <div class="pull-left">
                    <table style="width:100%">
                        <tbody><tr>
                            <td>
                                <button type="button" class="btn btn-sm btn-primary btnUpload" disabled="" id="btnKPDN013RNW170005_374390">Upload</button>
                                <input type="file" name="file" style="display: none; padding-left: 10px;" id="KPDN013RNW170005_374390">
                            </td>
                            <td style="padding-left: 10px">
                                <div class="label" style="color: blue; padding: 10px; display: none;" id="infoKPDN013RNW170005_374390">
                                    <center>
                                        <i class="fa fa-gear fa-4x fa-spin"></i><br>
                                        Store file in processing..<br> Please wait.. 
                                    </center>
                                </div>
                                <progress value="3" max="100" id="progressKPDN013RNW170005_374390" style="display: none;"></progress>
                            </td>
                            <td style="padding-left: 10px" id="descKPDN013RNW170005_374390"></td>
                        </tr>
                    </tbody></table>

                </div>

                <br>
                <div class="" id="divKPDN013RNW170005_374390"></div>
            </div>

            <script>
                /*<![CDATA[*/
                var prefix= 'KPDN013';
                var referenceId= 'KPDN013RNW170005_374390';
                var contextPath = '/BLESS2_PROD_TEST';
                var allowContentType = null;
                
                var upload_confirmation = null;
                var upload_confirmationTitle = null;
                var upload_confirmationContent = null;
                
                file_uploader(contextPath, 'private', prefix, referenceId, allowContentType, upload_confirmation);
                /*]]>*/
            </script>
        </div>
                </div>
            </td>
        </tr>
        <tr>
            <td width="5%" id="documentChecklist_generalCount">6</td>
            <td width="50%">Dokumen lain yang berkaitan</td>
            <td width="10%"></td>
            <td width="10%"></td>
            <td width="20%">
                <div class="form-group form-group-sm">
                    <div id="uploadFile">

            <div class="btn-group">
                <div class="pull-left">
                    <table style="width:100%">
                        <tbody><tr>
                            <td>
                                <button type="button" class="btn btn-sm btn-primary btnUpload" id="btnGENERAL_374390">Upload</button>
                                <input type="file" name="file" style="display: none; padding-left: 10px;" id="GENERAL_374390">
                            </td>
                            <td style="padding-left: 10px">
                                <div class="label" style="color: blue; padding: 10px; display: none;" id="infoGENERAL_374390">
                                    <center>
                                        <i class="fa fa-gear fa-4x fa-spin"></i><br>
                                        Store file in processing..<br> Please wait.. 
                                    </center>
                                </div>
                                <progress value="3" max="100" id="progressGENERAL_374390" style="display: none;"></progress>
                            </td>
                            <td style="padding-left: 10px" id="descGENERAL_374390"></td>
                        </tr>
                    </tbody></table>

                </div>

                <br>
                <div class="" id="divGENERAL_374390"></div>
            </div>

            <script>
                /*<![CDATA[*/
                var prefix= 'KPDN013';
                var referenceId= 'GENERAL_374390';
                var contextPath = '/BLESS2_PROD_TEST';
                var allowContentType = null;
                
                var upload_confirmation = null;
                var upload_confirmationTitle = null;
                var upload_confirmationContent = null;
                
                file_uploader(contextPath, 'private', prefix, referenceId, allowContentType, upload_confirmation);
                /*]]>*/
            </script>
        </div>
                </div>
            </td>
        </tr>
    </tbody></table></div>
</div>

<script>
/*<![CDATA[*/
    $(function(){
        $("#documentChecklist_generalCount").html(getGeneralDocumentChecklistCount());
    });
    
    function getGeneralDocumentChecklistCount(){
        var return_value = 0;
        $(".documentChecklist_count").each(function(){
            var val = parseInt($(this).attr("value"));
            return_value = val;
        });
        return return_value + 1;
    }
/*]]>*/
</script>
                                </div>
                            </div>
                        </div>
                        
                        <!--Perakuan-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="http://trainingb2.bless.gov.my/BLESS2_PROD_TEST/private/licKpdnkkPermitMain/renewal/374390#bahagianPerakuan">Perakuan</a></h4> 
                            </div>
                            <div id="bahagianPerakuan" class="panel-collapse collapse">
                                <div class="panel-body"> 
                                    <div class="form-group form-group-sm">
    <div class="col-md-12">
        <div class="checkbox checkbox-primary">
            <input id="isAgree" name="isAgree" type="checkbox" style="padding-left: 10px;">
            <label for="isAgree">Saya dengan ini mengesahkan bahawa, semua keterangan yang diberikan dalam borang iniadalah benar. Saya juga sedia maklum bahawa jika terdapat butir-butir yang dinyatakan tidak benar, pihak Kementerian Perdagangan Dalam Negeri, Koperasi dan Kepenggunaan (KPDNKK) berhak menarik balik dan membatalkan kelulusan yang dikeluarkan. Saya mengaku akan patuh kepada semua syarat yang ditetapkan, peraturan-peraturan atau syarat-syarat lain yang dikeluarkan dari semasa ke semasa.</label>
        </div>
    </div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-3 control-label">Nama Pemohon</label>
    <div class="col-md-4">
        <input type="text" class="form-control input-sm" readonly="" value="HENG CHEE CHENG" style="padding-left: 10px;">
    </div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-3 control-label">No. KP</label>
    <div class="col-md-4">
        <input type="text" class="form-control input-sm" readonly="" value="541122075265" style="padding-left: 10px;">
    </div>
</div>

<div class="form-group form-group-sm">
    <label class="col-md-3 control-label">Jawatan</label>
    <div class="col-md-4">
        <input type="text" class="form-control input-sm" readonly="" value="CHIEF OPERATING OFFICER" style="padding-left: 10px;">
    </div>
</div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

            </form>

            <div id="itemFormModalLocation"></div>
            
            <div id="itemSupplierListModalLocation"></div>
            <div id="itemSupplierFormModalLocation"></div>
            
            <div id="agencyFormModalLocation"></div>
            
        </div>
                
                <div id="usrAddressListModalLocation"></div>
                <div id="usrAddressFormModalLocation"></div>
                
            </div>
            <div style="padding: 10px; margin-top: 9px;" class="panel-footer">
                <table width="100%">
                    <tbody><tr>
                        <td>
            <div class="btn-group">
    <button type="button" id="btnBack" onclick="location.href = $(this).attr(&#39;url&#39;)" url="http://trainingb2.bless.gov.my/BLESS2_PROD_TEST/private/licLicenseRequest" class="btn btn-danger"><i class="fa fa-1x fa-fw fa-arrow-left"></i><span>Back</span></button>
</div>
<div class="btn-group">
    <a type="button" target="_blank" id="btnChecklist" disabled="disabled" href="http://trainingb2.bless.gov.my/BLESS2_PROD_TEST/private/licKpdnkkPermitMain/renewal/374390" class="btn btn-primary"><i class="fa fa-1x fa-fw fa-check-square-o"></i><span>Checklist &amp; Guidelines</span></a>
    <a type="button" id="btnPreview_online_form" class="btn btn-primary"><i class="fa fa-eye"></i>  <span>Preview</span></a>
</div>
<div class="btn-group pull-right">
    <button id="btnReset" type="button" class="btn btn-default"><i class="fa fa-1x fa-fw fa-refresh"></i><span>Reset</span></button>
    <button id="btnSave" type="button" class="btn btn-primary"><i class="fa fa-1x fa-fw fa-save"></i><span>Save</span></button>
   <!--<input type="button" onclick="self.close()" value="Close Window"/>-->
    <!-- <button onclick="toMytray()" type="button" class="btn btn-primary"><i class="fa fa-1x fa-fw fa-save"></i><span>Save2</span></button> -->
    <button id="btnSubmit" type="button" class="btn btn-primary"><i class="fa fa-1x fa-fw fa-paper-plane"></i><span>Submit</span></button>
</div>
        </td>
                    </tr>
                </tbody></table>
            </div>
        </div><div id="resultLoading" style="width: 100%; height: 100%; position: fixed; z-index: 10000000; top: 0px; left: 0px; right: 0px; bottom: 0px; margin: auto; display: none;"><div style="width: 250px; height: 75px; text-align: center; position: fixed; top: 0px; left: 0px; right: 0px; bottom: 0px; margin: auto; font-size: 16px; z-index: 10; color: rgb(255, 255, 255);"><div class="cssload-speeding-wheel"></div></div><div class="bg" style="background: rgb(255, 255, 255); opacity: 0.7; width: 100%; height: 100%; position: absolute; top: 0px;"></div></div>

        <!--Variables-->
        <script>
        /*<![CDATA[*/
            var context = '/BLESS2_PROD_TEST/' + "private/";
        /*]]>*/
        </script>
        
        <script>
            /*<![CDATA[*/
            var permitMain = {'DT_RowId':'51654','activity':null,'bless1LicenseSeq':'562125','businessTypeId':null,'committeeNo':null,'createdBy':139766,'createdTime':'2018-09-13T09:30:04.394+08:00','currentLocale':{'$type':'LANGUAGE','$name':'EN'},'email':'NGPW@SOONSOONGROUP.COM','endDate':null,'faxNo':null,'isAgree':false,'isHasReferenceNo1':true,'itemList':null,'licenseAgencyId':null,'licenseRequestId':374390,'messageSource':null,'mobileNo':null,'modifiedBy':0,'modifiedTime':'2018-09-13T09:30:04.394+08:00','pbtExpiryDate':null,'pbtLicenseNo':null,'permitMainId':51654,'phoneNo':null,'reason':'FOR INTERNAL USE','referenceNo1':'JBPM:PP/ZPI:700-5/1/20/443','referenceNo2':null,'referenceNo3':null,'request':null,'startDate':'2018-03-16T00:00:00.000+08:00','storeAddressId':775539};
            var permitMainId = 51654;
            var licRequestId = 374390;
            var licenseId =13;
            var applicantTypeCode = 'C';
            var customDocumentMandatoryCode = 'KPDN013NEW170005';

            $(function () {
                loadNonPetroleumItemList();
                loadPetroleumItemList();
                loadStorAddressList()
                loadItemSupplierList();
                loadAgency();
                enableDisableUploadBtn();
                checkApplicantType();
                checklist();
                checkIsHasReferenceNo1();
                checkForCustomDocumentMandatory();
            });
            /*]]>*/
        
            /*<![CDATA[*/           
            function validates(){
                var defaultValidation = [
                        {id: "mobileNo", message: "'No Telefon Bimbit'"},
                        {id: "applicantEmail", message: "'Email'"},
                        {id: "renewDate", message: "'Tarikh permohonan pembaharuan dipohon sehingga'"},
                        {id: "reasonBuy", message: "'Tujuan Pembelian'"},
                        {id: "isAgree", message: "'Perakuan'"}
                    ];
                    
                var defaultValidation2 = [
                    {id: "fireReferenceNo", message: "'Bahagian D - Butir-Butir Lesen/Kelulusan daripada Jabatan/Agensi' : 'No. Rujukan' 'Kelulusan Jabatan Bomba dan Penyelamat Malaysia'"}
                ];    
                
                var validation = defaultValidation;
                var is_has_reference_no_1 = $("#bombaY").is(':checked');
                if(is_has_reference_no_1 || checklist_item() > 0) {
                    validation = $.merge(defaultValidation, defaultValidation2);
                }
                    
                var resultCount = validateFormReturnsCountNoAlert(validation, "myform");
                var resultText = validateFormReturnsContent(validation, "myform");
                
                checkDocumentDetails(resultCount, resultText, 'Bahagian F : Document(s) softcopy upload is not complete');
            }
            
            function checkForCustomDocumentMandatory(){
                var is_has_reference_no_1 = $("#bombaY").is(':checked');
                if(is_has_reference_no_1 || checklist_item() > 0) {
                    customDocumentMandatory(customDocumentMandatoryCode);
                } else if (!is_has_reference_no_1 && checklist_item() === 0) {
                    removeCustomDocumentMandatory(customDocumentMandatoryCode);
                }
            }
            
            /*]]>*/
        
            /*<![CDATA[*/
            $("#btnSave").click(function(){
                validates();
            });
            
            $('#btnSubmit').click(function () {
                $("#action").val("submit");
                validates();
            });
            
            $("#btnReset").click(function(){
                resetForm("myform");
            });
            
            $("input, select, textarea").change(function(){
                checklist();
            });
            
            /*]]>*/
        </script>
        
        <script>
            /*<![CDATA[*/
            $(function () {
                $(".panel-heading").clone(true).appendTo("#divToolbar2");
                $(".dropthisup:eq(1)").addClass("dropup");
            });
            /*]]>*/
        </script>
        
        <!--Controls-->
        <script>
        /*<![CDATA[*/
            $("#btnPreview_online_form").click(function(){
                $.ajax({
                    url: window.location.pathname,
                    method: "POST",
                    data: $("#myform").serialize(),
                    success: function(){
                        window.open('http://trainingb2.bless.gov.my/BLESS2_PROD_TEST/private/pdf/form/374390', '_blank');
                    }
                });
            });
        /*]]>*/
        </script>
        
        <!--Address-->
        <script>
            /*<![CDATA[*/
            var usrAddressAjaxUrl = contextPath + "/private/usrAddress/ajax/"
            var selected_address_id = "";
            
            function toMytray(){
                console.log('d');
//          window.parent.closeIframe();
//parent.$('#modal-iframe').modal('hide');
window.parent.$("#test").dialog('close');

//               alert('ss');
            }
            
            function loadUsrAddressListModal(addressTypeId, functionAfterSelect){
                $.ajax({
                    url: usrAddressAjaxUrl + "loadUsrAddressListModal",
                    method: "GET",
                    success: function(modalHtml) {
                        $("#usrAddressListModalLocation").html(modalHtml);
                        loadUsrAddressList(addressTypeId, functionAfterSelect);
                        $("#usrAddressListModal").modal("show");
                        
                        $("#btnAddNewUsrAddress").click(function(){
                            loadUsrAddressFormModal(addressTypeId, functionAfterSelect);
                        });
                    }
                })
            }
            
            function loadUsrAddressList(addressTypeId, functionAfterSelect){
                $.ajax({
                   url: usrAddressAjaxUrl + "loadUsrAddressList/" + addressTypeId,
                   method: "GET",
                   success: function(listHtml) {
                        $("#usrAddressListLocation").html(listHtml);

                        $(".btnSelectUsrAddress").click(function(){
                            var selected = $(this).attr('selectid');
                            setSelectedUsrAddress(selected, functionAfterSelect);
                        });
                        
                        $(".btnDeleteUsrAddress").click(function(){
                            var selected = $(this).attr('selectid');
                            $.ajax({
                               url: usrAddressAjaxUrl + "deleteUsrAddress/" + selected,
                               method: "GET",
                               success: function(){
                                   loadUsrAddressList(addressTypeId, functionAfterSelect);
                               }
                            });
                        });
                   }
                });
            }
            
            function setSelectedUsrAddress(addressId, functionAfterSelect){
                selected_address_id = addressId;
                $("#usrAddressListModal").modal("hide");
                functionAfterSelect();
            }
            
            function loadUsrAddressFormModal(addressTypeId, functionAfterSelect){
                $.ajax({
                   url: usrAddressAjaxUrl + "loadUsrAddressFormModal/" + addressTypeId,
                   method: "GET",
                   success: function(formModalHtml){
                        $("#usrAddressFormModalLocation").html(formModalHtml);
                        customSetup();
                        $("#usrAddressFormModal").modal("show");
                       
                        $("#stateCode", "#usrAddressForm").change(function(){
                            loadCityByState("stateCode", "cityId", function(){}, "usrAddressForm");
                        });
                       
                        $("#btnResetUsrAddressForm").click(function(){
                           resetForm("usrAddressForm");
                        });
                       
                        $("#btnSaveUsrAddress").click(function(){
                            var countryCode = $('#countryCode').val();
                            var usrAddressFormValidation = 0;
                            if(countryCode === 'MY'){
                                console.log("SELECTED COUNTRY IS MALAYSIA !!!");
                                usrAddressFormValidation = validateForm([
                                    {id:"address1", message:"'Alamat Baris 1'"},
                                    {id:"postcode", message:"'Poskod'"},
                                    {id:"stateCode", message:"'Negeri'"},
                                    {id:"cityId", message:"'Bandar'"},
                                    {id:"countryCode", message:"'Negara'"}
                                ], "usrAddressForm");
                                
                            }else{
                                console.log("SELECTED COUNTRY IS NOT MALAYSIA !!!");
                                usrAddressFormValidation = validateForm([
                                    {id:"address1", message:"'Alamat Baris 1'"},
                                    {id:"countryCode", message:"'Negara'"},
                                    {id:"postcodeOther", message:"'Poskod'"}
                                ], "usrAddressForm");
                            }
                            
                            if(usrAddressFormValidation == 0) {
                                $.ajax({
                                    url: usrAddressAjaxUrl + "add",
                                    method: "POST",
                                    data: $("#usrAddressForm").serialize(),
                                    success: function(result) {
                                        if(result == 1) {
                                            loadUsrAddressList(addressTypeId, functionAfterSelect);
                                            $("#usrAddressFormModal").modal("hide");
                                        } else {
                                            errorAlert();
                                        }
                                    }
                                })
                            }
                       });
                   }
                });
            }
            
            function getAddressData(id, function_callback){
                $.ajax({
                    url: context + "usrAddress/ajax/getUsrAddress/" + id,
                    method: "GET",
                    success: function(data) {
                        var address = formatAddressVertical(data.address1, data.address2, data.address3, data.postcode, data.cityName, data.stateName, '');
                        data.fullAddress = address;
                        function_callback(data);
                    }
                });
            }
            
            function loadAddressToTextarea(textareaId, addressId){
                if(addressId != null) {
                    getAddressData(addressId, function(data){
                        $("#" + textareaId).val(data.fullAddress);
                    });
                } else {
                    $("#" + textareaId).val('No data found');
                }
            }
            
            function loadAddressToTextarea2(textareaId, addressId){
                if(addressId != null) {
                    getAddressData(addressId, function(data){
                        $("#" + textareaId).val(data.fullAddress);
                    });
                } 
//                else {
//                    $("#" + textareaId).val('No data found');
//                }
            }
            /*]]>*/
        </script>
        
        <!--Online Form Validation & Documents Checking-->
        <script>
            /*<![CDATA[*/
            var licenseRequest = {'DT_RowId':null,'actionName':null,'agencyComment':null,'agencyName':null,'agencyRefNo':null,'agencyReferenceNo':null,'agencyStateId':null,'amountPayment':0.0,'applicantDueDate':null,'applicantTypeId':1,'asNewExpiredDate':null,'asNewLicenseNo':null,'brandId':null,'brandOthers':null,'checkPointName':'checkpoint_name','checklistAction':null,'checkpointAction':null,'checkpointDueDate':null,'checkpointId':null,'claimDate':null,'claimerUserName':null,'collectionAddress':null,'collectionChecklistType':null,'completeDate':null,'contactNo':null,'contactPerson':null,'createDate':'2018-09-13T00:00:00.000+08:00','createUserProfileId':139766,'createdBy':null,'createdTime':null,'currentLicenseMainId':37922,'currentLocale':{'$type':'LANGUAGE','$name':'EN'},'designation':null,'draftNo':'DN22018015171','dueDate':null,'formStatus':null,'formStatusId':1,'isAgree':0,'isDelete':0,'isEmail':false,'isHerebyForm':false,'licenseAgencyId':5625,'licenseCode':null,'licenseFormId':20,'licenseId':13,'licenseMainId':null,'licenseMetaId':55,'licenseName':null,'licenseRef':null,'licenseRequestId':374390,'licenseRequestNo':'DN22018015171','licenseStatusDesc':null,'licenseType':null,'licenseTypeDesc':'license_type_desc','messageSource':null,'modifiedBy':null,'modifiedTime':null,'onlineFormAction':null,'orgOrganisationName':null,'orgReferenceId':93576,'organisationBranchId':null,'organisationId':null,'organisationName':'','paymentMethodId':null,'prevLicenseNo':'P013927','previewAction':null,'previousUser':null,'printedDate':null,'reasonReprintId':null,'receiptNo':null,'receivedDate':null,'refLicenseMetaId':null,'remarks':null,'request':null,'rtaApplicantName':null,'sectorId':null,'serialNo':null,'submissionCheckpointId':null,'submissionDate':null,'submissionStatusDesc':null,'submissionStatusId':null,'totalPayment':0.0};
            var licenseRequestId = 374390;
            var prefix = 'KPDN013';
            
            function enableDisableUploadBtn() {
                $("[id*=_softcopy]").each(function(){
                    var thiz_id = this.id;
                    var btn_id = _replace(thiz_id, '_softcopy', '');
                    btn_id = 'btn' + btn_id + '_' + licenseRequestId;
                    if(this.checked) {
                        $('#' + btn_id).prop('disabled', false);
                    } else {
                        $('#' + btn_id).prop('disabled', true);
                    }
                });
            }
            
            function checkDocumentDetails(resultCount, resultText, warningText){
                console.log("INSIDE checkDocumentDetails");
                console.log("resultText == "+resultText);
                console.log("WarningText == "+warningText)
                $("[id*=_softcopy][mandatory=true]").each(function(){
                    if(!this.checked) {
                        var warning = 'Bahagian E : Please tick document(s)\'s softcopy that are mandatory';
                        resultText = resultText + '<br>' + ++resultCount + '. ' + warning;
                        return false;
                    }
                });
                
                var documentConfigCodes = [];
                $("[id*=_softcopy]:checked").each(function(){
                    var documentConfigCode = _replace(this.id, '_softcopy', '');
                    documentConfigCodes.push(documentConfigCode);
                });
                
                if(documentConfigCodes.length > 0) {
                    $.ajax({
                        url: contextPath + "/private/licLicenseDocument/checkDocumentDetails/" + prefix + '/' + licenseRequestId,
                        method: "POST",
                        data: "documentConfigCodes=" + documentConfigCodes.toString(),
                        success: function(result) {
                            if(result == 'FAIL') {
                                var warning = warningText;
                                if(warningText == null) {
                                    warning = 'Bahagian E : Document(s) softcopy upload is not complete';
                                }
                                resultText = resultText + '<br>' + ++resultCount + '. ' + warning;
                            }
                            proceed($('#action').val(), resultText);
                        }
                    })
                } else {
                    proceed($('#action').val(), resultText);
                }
                
            }
            
            function checkDocumentDetails1(resultCount, resultText, warningText){
                
                $("[id*=_softcopy][mandatory=true]").each(function(){
                    if(!this.checked) {
                        var warning = 'Bahagian E : Please tick document(s)\'s softcopy that are mandatory';
                        resultText = resultText + '<br>' + ++resultCount + '. ' + warning;
                        return false;
                    }
                });
                
                var documentConfigCodes = [];
                $("[id*=_softcopy]:checked").each(function(){
                    var documentConfigCode = _replace(this.id, '_softcopy', '');
                    documentConfigCodes.push(documentConfigCode);
                });
                
                if(documentConfigCodes.length > 0) {
                    $.ajax({
                        url: contextPath + "/private/licLicenseDocument/checkDocumentDetails/" + prefix + '/' + licenseRequestId,
                        method: "POST",
                        data: "documentConfigCodes=" + documentConfigCodes.toString(),
                        success: function(result) {
                            if(result == 'FAIL') {
                                var warning = warningText;
                                if(warningText == null) {
                                    warning = 'Bahagian G : Document(s) softcopy upload is not complete';
                                }
                                resultText = resultText + '<br>' + ++resultCount + '. ' + warning;
                            }
                            proceed($('#action').val(), resultText);
                        }
                    })
                } else {
                    proceed($('#action').val(), resultText);
                }
                
            }
            
            function checkDocumentDetails2(resultCount, resultText, warningText){
                
                $("[id*=_softcopy][mandatory=true]").each(function(){
                    if(!this.checked) {
                        var warning = 'Bahagian E : Please tick document(s)\'s softcopy that are mandatory';
                        resultText = resultText + '<br>' + ++resultCount + '. ' + warning;
                        return false;
                    }
                });
                
                var documentConfigCodes = [];
                $("[id*=_softcopy]:checked").each(function(){
                    var documentConfigCode = _replace(this.id, '_softcopy', '');
                    documentConfigCodes.push(documentConfigCode);
                });
                
                if(documentConfigCodes.length > 0) {
                    $.ajax({
                        url: contextPath + "/private/licLicenseDocument/checkDocumentDetails/" + prefix + '/' + licenseRequestId,
                        method: "POST",
                        data: "documentConfigCodes=" + documentConfigCodes.toString(),
                        success: function(result) {
                            if(result == 'FAIL') {
                                var warning = warningText;
                                if(warningText == null) {
                                    warning = 'Bahagian F : Document(s) softcopy upload is not complete';
                                }
                                resultText = resultText + '<br>' + ++resultCount + '. ' + warning;
                            }
                            proceed($('#action').val(), resultText);
                        }
                    })
                } else {
                    proceed($('#action').val(), resultText);
                }
                
            }
            
            function checkDocumentDetails3(resultCount, resultText, warningText){
                $("[id*=_softcopy][mandatory=true]").each(function(){
                    if(!this.checked) {
                        var warning = 'Bahagian F : Please tick document(s)\'s softcopy that are mandatory';
                        resultText = resultText + '<br>' + ++resultCount + '. ' + warning;
                        return false;
                    }
                });
                
                var documentConfigCodes = [];
                $("[id*=_softcopy]:checked").each(function(){
                    var documentConfigCode = _replace(this.id, '_softcopy', '');
                    documentConfigCodes.push(documentConfigCode);
                });
                
                if(documentConfigCodes.length > 0) {
                    $.ajax({
                        url: contextPath + "/private/licLicenseDocument/checkDocumentDetails/" + prefix + '/' + licenseRequestId,
                        method: "POST",
                        data: "documentConfigCodes=" + documentConfigCodes.toString(),
                        success: function(result) {
                            if(result == 'FAIL') {
                                var warning = warningText;
                                if(warningText == null) {
                                    warning = 'Bahagian E : Document(s) softcopy upload is not complete';
                                }
                                resultText = resultText + '<br>' + ++resultCount + '. ' + warning;
                            }
                            proceed($('#action').val(), resultText);
                        }
                    })
                } else {
                    proceed($('#action').val(), resultText);
                }
            }
            
            function proceed(action, resultText){
                if(resultText != '') {
                    if(action == 'submit') {
                        alertCallbackY('Please complete all required field(s)', '<div align="left"><b>Field(s) required:</b>' + resultText + '</div>', 'OK', function(){
                            $('#action').val('');
                        });
                    } else {
                        alertCallbackYN('Form is incomplete.<br>Proceed to save?', '<div align="left"><b>Field(s) required:</b>' + resultText + '</div>', '', function(){
                            $("#action").val("saveIncomplete");
                            $("#myform").submit();
                        }, function(){
                            $('action').val('');
                        });
                    }
                } else {
                    if(action == 'submit') {
                        var submit_confirm_title = 'Are you sure to submit this form?';
                        var submit_confirm_content = 'Changes can\'t be made after submission';
                        alertCallbackYN(submit_confirm_title, submit_confirm_content, '', function(){
                            $("#myform").submit();
                        }, function(){
                            $('#action').val('');
                        });
                    } else {
                        $("#action").val("saveComplete");
                        $("#myform").submit();
                    }
                }
            }
            
            function checkDocumentMandatory(condition, item_ids){
                if(condition) {
                    removeCustomDocumentMandatory();
                    
                    $.ajax({
                        url: context + "refItemDocument/ajax/findDocumentConfigToOverwrite/" + licenseRequest.licenseMetaId,
                        method: "GET",
                        data: "ids=" + item_ids,
                        success: function(data){
                            $.each(data, function(a, b){
                                customDocumentMandatory(b.code);
                            });
                        }
                    });
                } else {
                    removeCustomDocumentMandatory();
                }
                
            }
            
            function removeCustomDocumentMandatory(code){
                if(code) {
                    $("." + code + "_dcm").remove();
                    $("." + code + "_cm").attr('mandatory', 'false');
                } else {
                    $(".document_checklist_mandatory").remove();
                    $(".custom_mandatory").attr('mandatory', 'false');
                }
            }
            
            function customDocumentMandatory(code){
                var count = 0;
                $("." + code + "_dcm").each(function(){
                    count++;
                });
                
                if(count === 0) {
                    $("#" + code + "_label_span").append("<b class='document_checklist_mandatory " + code + "_dcm' style='color: red'> *</b>");
                    $("#" + code + "_softcopy").addClass('custom_mandatory ' + code + '_cm');
                    $("#" + code + "_softcopy").attr('mandatory', 'true');
                }
            }
            /*]]>*/
        </script>
        
        <!--Documents-->
        <script>
        /*<![CDATA[*/
        
            function loadDocumentData(prefix, licenseRequest, activityCodes, itemCodes){
                
                if(activityCodes == null) {
                    activityCodes = "";
                }
                
                if(itemCodes == null) {
                    itemCodes = "";
                }
                
                $.ajax({
                   url: context + "licLicenseDocument/loadDocument/" + prefix + "/" + licenseRequest.licenseRequestId,
                   method: "GET",
                   data: "activityCodes=" + activityCodes + "&itemCodes=" + itemCodes,
                   success: function(data){
                       $("#documentLocation").html(data);
                       customSetup();
                   }
                });
                
            }
        
        /*]]>*/
        </script>
    

<div id="divSmallBoxes"></div><div id="divMiniIcons"></div><div id="divbigBoxes"></div><div id="ui-datepicker-div" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div></body><div></div></html>